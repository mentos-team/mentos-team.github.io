<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.9.1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MentOS: mentos/src/process/process.c Source File</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                    <tr style="height: 56px;">
                        <td id="projectalign" style="padding-left: 0.5em;">
                            <div id="projectname">MentOS
                                &#160;<span id="projectnumber">0.5.2</span>
                            </div>
                            <div id="projectbrief">The Mentoring Operating System</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part --><!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b4d46abdb8cafe1ad6c14fa0f9992e34.html">mentos</a></li><li class="navelem"><a class="el" href="dir_d299fed5c83b024e8b5c525a233be574.html">src</a></li><li class="navelem"><a class="el" href="dir_b2479b03a349f62f8285d50699dfa9b8.html">process</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">process.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="process_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Include the kernel log levels.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kernel__levels_8h.html">sys/kernel_levels.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="process_8c.html#ae88fdea60e151933ce52a92938897dac">    9</a></span>&#160;<span class="preprocessor">#define __DEBUG_HEADER__ &quot;[PROC  ]&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="process_8c.html#a785e7dc04a8b1423d105b10f7af0720c">   11</a></span>&#160;<span class="preprocessor">#define __DEBUG_LEVEL__ LOGLEVEL_NOTICE</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="process_8h.html">process/process.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="scheduler_8h.html">process/scheduler.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="assert_8h.html">assert.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libgen_8h.html">libgen.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string_8h.html">string.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="timer_8h.html">hardware/timer.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;sys/errno.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fcntl_8h.html">fcntl.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="panic_8h.html">system/panic.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mentos_2inc_2io_2debug_8h.html">io/debug.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mentos_2inc_2process_2wait_8h.html">process/wait.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="prio_8h.html">process/prio.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vfs_8h.html">fs/vfs.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="elf_8h.html">elf/elf.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="stack__helper_8h.html">klib/stack_helper.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="process_8c.html#a360b960e9d73f0b087cbd05790218aa9">   30</a></span>&#160;<span class="keyword">static</span> <a class="code" href="structkmem__cache__t.html">kmem_cache_t</a> *<a class="code" href="process_8c.html#a360b960e9d73f0b087cbd05790218aa9">task_struct_cache</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">   32</a></span>&#160;<span class="keyword">static</span> <a class="code" href="structtask__struct.html">task_struct</a> *<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="process_8c.html#a3de12e2df80906e114483ac212f9a3b4">   37</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="process_8c.html#a3de12e2df80906e114483ac212f9a3b4">__count_args</a>(<span class="keywordtype">char</span> **args)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">int</span> argc = 0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">while</span> (args[argc] != <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        ++argc;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">return</span> argc;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="process_8c.html#ab6cda375a61ffc2198644d07c98a1f44">   48</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="process_8c.html#ab6cda375a61ffc2198644d07c98a1f44">__count_args_bytes</a>(<span class="keywordtype">char</span> **args)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// Count the number of arguments.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">int</span> argc = <a class="code" href="process_8c.html#a3de12e2df80906e114483ac212f9a3b4">__count_args</a>(args);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// Count the number of characters.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">int</span> nchar = 0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; argc; i++) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        nchar += <a class="code" href="mentos_2src_2klib_2string_8c.html#aa383452fe445bfae989358c9d7d96f4f">strlen</a>(args[i]) + 1;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">return</span> nchar + (argc + 1 <span class="comment">/* The NULL terminator */</span>) * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">   64</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">char</span> **<a class="code" href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">__push_args_on_stack</a>(<a class="code" href="stdint_8h.html#a19e3e47d795881e91fde03c3f592bef4">uintptr_t</a> *stack, <span class="keywordtype">char</span> *args[])</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// Count the number of arguments.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">int</span> argc = <a class="code" href="process_8c.html#a3de12e2df80906e114483ac212f9a3b4">__count_args</a>(args);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// Prepare args with space for the terminating NULL.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">char</span> *args_location[256];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = argc - 1; i &gt;= 0; --i) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code" href="mentos_2src_2klib_2string_8c.html#aa383452fe445bfae989358c9d7d96f4f">strlen</a>(args[i]); j &gt;= 0; --j) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(*stack, args[i][j]);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        args_location[i] = (<span class="keywordtype">char</span> *)(*stack);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// Push terminating NULL.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(*stack, (<span class="keywordtype">char</span> *)<a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// Push array of pointers to the arguments.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = argc - 1; i &gt;= 0; --i) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(*stack, args_location[i]);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">char</span> **)(*stack);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> __reset_process(<a class="code" href="structtask__struct.html">task_struct</a> *task)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;__reset_process(%p `%s`)\n&quot;</span>, task, task-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// Create a new stack segment.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    task-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a> = <a class="code" href="paging_8h.html#a012755fb79dfee593f8eab6559fc7c3e">create_blank_process_image</a>(<a class="code" href="process_8h.html#a87dcbc4991a2a2fc4eb6fc6a24449f26">DEFAULT_STACK_SIZE</a>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (task-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a> == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;Failed to initialize process mm structure.\n&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// Save the current page directory.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="structpage__directory__t.html">page_directory_t</a> *crtdir = <a class="code" href="paging_8h.html#a53a0eb525b1c0d63f56ea27b671c77f7">paging_get_current_directory</a>();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// FIXME: Now to clear the stack a pgdir switch is made, it should be a kernel mmapping.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="paging_8h.html#a275110d039474e166124734b3c76e5ea">paging_switch_directory_va</a>(task-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a62b4019cc9b1183e0844041b2a587ba1">pgd</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Clean stack space.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="mentos_2src_2klib_2string_8c.html#a4cb469bec7b722064b97a406346acb61">memset</a>((<span class="keywordtype">char</span> *)task-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#ab2fd92beef57a21eed753ea54db4d2f7">start_stack</a>, 0, <a class="code" href="process_8h.html#a87dcbc4991a2a2fc4eb6fc6a24449f26">DEFAULT_STACK_SIZE</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// Set the base address of the stack.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    task-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#ad7a8313b36ac46e9ea5fb756b8729ed7">ebp</a> = (<a class="code" href="stdint_8h.html#a19e3e47d795881e91fde03c3f592bef4">uintptr_t</a>)(task-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#ab2fd92beef57a21eed753ea54db4d2f7">start_stack</a> + <a class="code" href="process_8h.html#a87dcbc4991a2a2fc4eb6fc6a24449f26">DEFAULT_STACK_SIZE</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// Set the top address of the stack.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    task-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a> = task-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#ad7a8313b36ac46e9ea5fb756b8729ed7">ebp</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Enable the interrupts.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    task-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#ab98af36ae408b8b40fee6b32f26d1955">eflags</a> = task-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#ab98af36ae408b8b40fee6b32f26d1955">eflags</a> | <a class="code" href="mentos_2inc_2sys_2types_8h.html#a321a0f206107c6aeee36068c02bb9da5a3ce22e8b74580f9c4b2bfaa163746322">EFLAG_IF</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Restore previous pgdir</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="paging_8h.html#acb7c264c90dcd844da63c60d4886dab0">paging_switch_directory</a>(crtdir);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> __load_executable(<span class="keyword">const</span> <span class="keywordtype">char</span> *path, <a class="code" href="structtask__struct.html">task_struct</a> *task, <a class="code" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *entry)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;__load_executable(`%s`, %p `%s`, %p)\n&quot;</span>, path, task, task-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>, entry);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="structvfs__file__t.html">vfs_file_t</a> *file = <a class="code" href="vfs_8h.html#a103648a7259f3be7ca1f79b3d247359b">vfs_open</a>(path, <a class="code" href="fcntl_8h.html#a7a68c9ffaac7dbcd652225dd7c06a54b">O_RDONLY</a>, 0);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (file == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;Cannot find executable!\n&quot;</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// Check that the file is actually an executable before destroying the `mm`.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="elf_8h.html#a6f4c944f618ecde6500a1dae657f62cd">elf_check_file_type</a>(file, <a class="code" href="elf_8h.html#ae705110a6320d7ca1cd35cf11ecabde3aff80e596d1ea270d3913f3b2307e3e2b">ET_EXEC</a>)) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;This is not a valid ELF executable `%s`!\n&quot;</span>, path);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// FIXME: When threads will be implemented</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// they should share the mm, so the destroy_process_image must be called</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// only when all the threads are terminated. This can be accomplished by using</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// an internal counter on the mm.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (task-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="paging_8h.html#a195bae4ec2a8ec60d1bb1c1d66a44c80">destroy_process_image</a>(task-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// Return code variable.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Recreate the memory of the process.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (__reset_process(task)) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// Load the elf file, check if 0 is returned and print the error.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (!(ret = <a class="code" href="elf_8h.html#aca03bad05548bf29e58fac485fdd2804">elf_load_file</a>(task, file, entry))) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;Failed to load ELF file `%s`!\n&quot;</span>, path);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// Close the file.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="vfs_8h.html#a6e3812039538e7780756472cdb932086">vfs_close</a>(file);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structtask__struct.html">task_struct</a> *__alloc_task(<a class="code" href="structtask__struct.html">task_struct</a> *source, <a class="code" href="structtask__struct.html">task_struct</a> *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;{</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// Create a new task_struct.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="structtask__struct.html">task_struct</a> *proc = <a class="code" href="slab_8h.html#a1d06cf91e5fab6317cd5a704007f1871">kmem_cache_alloc</a>(<a class="code" href="process_8c.html#a360b960e9d73f0b087cbd05790218aa9">task_struct_cache</a>, <a class="code" href="group__gfp__flag__combinations.html#ga44b9e863fd60efc9018a5524b77532ee">GFP_KERNEL</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// Clear the memory.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="mentos_2src_2klib_2string_8c.html#a4cb469bec7b722064b97a406346acb61">memset</a>(proc, 0, <span class="keyword">sizeof</span>(<a class="code" href="structtask__struct.html">task_struct</a>));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// Set the id of the process.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#afc180f9e1e6ace46019d9560d008b515">pid</a> = <a class="code" href="scheduler_8h.html#aa988c36c45404bc72d2d484af3453af5">scheduler_getpid</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// Set the state of the process as running.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a87a3d5ad21a9dddfed14474e06ed16fb">state</a> = <a class="code" href="mentos_2inc_2process_2wait_8h.html#a17e3f99a030e5dfefb8f9815600e3fed">TASK_RUNNING</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// Set the current opened file descriptors and the maximum number of file descriptors.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (source)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="vfs_8h.html#a656125edb733622bdd879037a3986411">vfs_dup_task</a>(proc, source);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="vfs_8h.html#a660060cf4085fd34e511f81921e38e56">vfs_init_task</a>(proc);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// Set the pointer to process&#39;s parent.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#ae8f3745f8f0965e880550784b7f33790">parent</a> = parent;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Initialize the list_head.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="list__head_8h.html#a1d8fce796637606fb5366d7edc076cd3">list_head_init</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#aed999fed29759312b5c75d5f3dae5631">run_list</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Initialize the children list_head.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="list__head_8h.html#a1d8fce796637606fb5366d7edc076cd3">list_head_init</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a8e1eeb14f703a13dd30762bfdad9fbf1">children</a>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// Initialize the sibling list_head.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="list__head_8h.html#a1d8fce796637606fb5366d7edc076cd3">list_head_init</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a11dbdec8ca1c07f55939cc177675417b">sibling</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// If we have a parent, set the sibling child relation.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (parent) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// Set the new_process as child of current.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="list__head_8h.html#a6cacd6ad6863aae47561df20604bdcac">list_head_insert_before</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a11dbdec8ca1c07f55939cc177675417b">sibling</a>, &amp;parent-&gt;<a class="code" href="structtask__struct.html#a8e1eeb14f703a13dd30762bfdad9fbf1">children</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (source)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="mentos_2src_2klib_2string_8c.html#a37562939be846210ce0560a6168cd7f1">memcpy</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>, &amp;source-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>, <span class="keyword">sizeof</span>(<a class="code" href="structthread__struct__t.html">thread_struct_t</a>));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// Set the statistics of the process.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a91a8e2117841c08b1275c47dbf009dbb">uid</a>                   = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a225f2beda1e687c2f1a1219d5eed4264">gid</a>                   = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#af87ae9f3a8a1bf7e6333909836d7ae68">sid</a>                   = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a604a8ed7213cf3158b0c66ae37cb151b">pgid</a>                  = 0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#ac988c4f4160543d00587196a422f0372">prio</a>               = <a class="code" href="prio_8h.html#a0cbf26ad705a078d6a1ac13555630ccc">DEFAULT_PRIO</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a4f3c88b9601fe23334164249919d416a">start_runtime</a>      = <a class="code" href="timer_8h.html#ae23bd2d068dae6da28f9dc8226a7138f">timer_get_ticks</a>();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#ad1a64c4cc30f02251081f5624ed2fb87">exec_start</a>         = <a class="code" href="timer_8h.html#ae23bd2d068dae6da28f9dc8226a7138f">timer_get_ticks</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a4a57005049b5d146bfdda652b9559ceb">exec_runtime</a>       = 0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#ab9d7d6623a4643c4064fff66e053bcab">sum_exec_runtime</a>   = 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a3026f6f756dd93d52e16b817273881a8">vruntime</a>           = 0;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a2e65fe87ad396407c3af185d4b0a3d67">period</a>             = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a6486a4267567a1e952b76f2545ab6fb9">deadline</a>           = 0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a68421c07d1b113166935ca5bed2477f1">arrivaltime</a>        = <a class="code" href="timer_8h.html#ae23bd2d068dae6da28f9dc8226a7138f">timer_get_ticks</a>();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#afed011cb6ff510d62bf1559f1590a051">executed</a>           = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a586727071202ba8ca308cef26ae34ed0">is_periodic</a>        = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a3721bb8381ad787cc48af2b50cceb73b">is_under_analysis</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a405ab87ffe6773166d735bb43a1f445e">next_period</a>        = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#a2de9d073eb3f990f996e0686ff4d1bd9">worst_case_exec</a>    = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">se</a>.<a class="code" href="structsched__entity__t.html#ad9ae10141d13aa58ab6ec68bddc2e320">utilization_factor</a> = 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// Initialize the exit code of the process.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#ad9da706c569dce6f2cbe25498b7aa96b">exit_code</a> = 0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Copy the name.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (name)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="mentos_2src_2klib_2string_8c.html#a1a8e0d046aa6ccaf2c9947e3142e4786">strcpy</a>(proc-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>, name);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// Do not touch the task&#39;s segments.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a> = <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// Initialize the error number.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#ac96426eb73337a26f33fb75a6aa97ac3">error_no</a> = 0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// Initialize the current working directory.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (source)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="mentos_2src_2klib_2string_8c.html#a1a8e0d046aa6ccaf2c9947e3142e4786">strcpy</a>(proc-&gt;<a class="code" href="structtask__struct.html#a7c21f2477fef8029c5ffaa7dd9701b66">cwd</a>, source-&gt;<a class="code" href="structtask__struct.html#a7c21f2477fef8029c5ffaa7dd9701b66">cwd</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="mentos_2src_2klib_2string_8c.html#a1a8e0d046aa6ccaf2c9947e3142e4786">strcpy</a>(proc-&gt;<a class="code" href="structtask__struct.html#a7c21f2477fef8029c5ffaa7dd9701b66">cwd</a>, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// Clear the signal handler.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="mentos_2src_2klib_2string_8c.html#a4cb469bec7b722064b97a406346acb61">memset</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a166eff6587e4913092014dc79f24e219">sighand</a>, 0x00, <span class="keyword">sizeof</span>(<a class="code" href="structsighand__t.html">sighand_t</a>));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="spinlock_8h.html#a2749c4e36328ae3aca1ea05e4002d940">spinlock_init</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a166eff6587e4913092014dc79f24e219">sighand</a>.<a class="code" href="structsighand__t.html#aafa193b462b7ef7805dd23f6165080c7">siglock</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="stdatomic_8h.html#a25e8927e307eceed0b2a83b86b7e62d0">atomic_set</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a166eff6587e4913092014dc79f24e219">sighand</a>.<a class="code" href="structsighand__t.html#a9bf1d7c5b83d6c1a4cdf8f20075d234e">count</a>, 0);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NSIG; ++i) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        proc-&gt;<a class="code" href="structtask__struct.html#a166eff6587e4913092014dc79f24e219">sighand</a>.<a class="code" href="structsighand__t.html#a27c78f9500324fbd88db660d133a5151">action</a>[i].<a class="code" href="structsigaction__t.html#ae83dcfae8a4765fb16d883b22b05233f">sa_handler</a> = <a class="code" href="mentos_2inc_2system_2signal_8h.html#a27d5dc561093d6243542e6a2465bc0f8">SIG_DFL</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="mentos_2inc_2system_2signal_8h.html#a5925352f90eb589393274fa0376d7def">sigemptyset</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a166eff6587e4913092014dc79f24e219">sighand</a>.<a class="code" href="structsighand__t.html#a27c78f9500324fbd88db660d133a5151">action</a>[i].<a class="code" href="structsigaction__t.html#adf8abbef124ab01c519b8bc3e09e1588">sa_mask</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        proc-&gt;<a class="code" href="structtask__struct.html#a166eff6587e4913092014dc79f24e219">sighand</a>.<a class="code" href="structsighand__t.html#a27c78f9500324fbd88db660d133a5151">action</a>[i].<a class="code" href="structsigaction__t.html#a4bf7cbd88a54a6683dcb438456fcaed9">sa_flags</a> = 0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// Clear the masks.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="mentos_2inc_2system_2signal_8h.html#a5925352f90eb589393274fa0376d7def">sigemptyset</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a09266333fd5a7f08d79df3bec124bc02">blocked</a>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="mentos_2inc_2system_2signal_8h.html#a5925352f90eb589393274fa0376d7def">sigemptyset</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#abee19f114e04018f4502b79e07906614">real_blocked</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="mentos_2inc_2system_2signal_8h.html#a5925352f90eb589393274fa0376d7def">sigemptyset</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#adf88d82850f399c473998758ea3c6ba7">saved_sigmask</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// Initialzie the data structure storing the pending signals.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="list__head_8h.html#a1d8fce796637606fb5366d7edc076cd3">list_head_init</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a05ab594e57bfe65f52fee4e4a64c6ae8">pending</a>.<a class="code" href="structsigpending__t.html#abf2a45f1d6b3cbc09e287a17b825ad35">list</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="mentos_2inc_2system_2signal_8h.html#a5925352f90eb589393274fa0376d7def">sigemptyset</a>(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a05ab594e57bfe65f52fee4e4a64c6ae8">pending</a>.<a class="code" href="structsigpending__t.html#a6410039ddfa2e759ed9e757c0343296d">signal</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// Initalize real_timer for intervals</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a3d9992a8fc049fa059d2b3d6b9f33d84">real_timer</a> = <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// Set the default terminal options.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a9ce8a6402466dc66f29a068f1018cccd">termios</a> = (<a class="code" href="termios-struct_8h.html#a785e51f802fcd542f2acf152438db6f9">termios_t</a>){</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        .<a class="code" href="structtermios.html#a5d42b95faa4745c3bea53652d2812162">c_cflag</a> = 0,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        .c_lflag = (<a class="code" href="termios-struct_8h.html#a58265a371303d00a4a3b1f128d72c21e">ICANON</a> | <a class="code" href="termios-struct_8h.html#aad1dc60a04a1d8cfc8b3ded13601e361">ECHO</a> | <a class="code" href="termios-struct_8h.html#aac931d3ce0dfc4578f76879ed095ecd7">ECHOE</a> | <a class="code" href="termios-struct_8h.html#a6695c16777cf8a5211cfba9a23d45985">ECHOK</a> | <a class="code" href="termios-struct_8h.html#ad99516e614e3aa680dfc0052085de40a">ECHONL</a> | <a class="code" href="termios-struct_8h.html#a52c605497d066b9ae7407124f84806a7">ISIG</a>),</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        .c_oflag = 0,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        .c_iflag = 0</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    };</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// Initialize the ringbuffer.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    fs_rb_scancode_init(&amp;proc-&gt;<a class="code" href="structtask__struct.html#a826ddf06710b68d6162078018fc889a0">keyboard_rb</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> proc;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="process_8h.html#a12e0316d44416bfe809d434edfb2ac16">  245</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="process_8c.html#a12e0316d44416bfe809d434edfb2ac16">init_tasking</a>()</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="process_8c.html#a360b960e9d73f0b087cbd05790218aa9">task_struct_cache</a> = <a class="code" href="slab_8h.html#ac47373f9f4512eda4e3a27eb262485b3">KMEM_CREATE</a>(<a class="code" href="structtask__struct.html">task_struct</a>)) == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="process_8h.html#a4435a6322e406ac1eba8fbe225c52877">  253</a></span>&#160;<a class="code" href="structtask__struct.html">task_struct</a> *<a class="code" href="process_8c.html#a4435a6322e406ac1eba8fbe225c52877">process_create_init</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *path)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;{</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;Building init process...\n&quot;</span>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// Allocate the memory for the process.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a> = __alloc_task(<a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;init&quot;</span>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// == INITIALIZE `/proc/video` ============================================</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// Check that the fd_list is initialized.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="assert_8h.html#a0041af519e0e7d47c9bcc83760c4669e">assert</a>(<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">fd_list</a> &amp;&amp; <span class="stringliteral">&quot;File descriptor list not initialized.&quot;</span>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="assert_8h.html#a0041af519e0e7d47c9bcc83760c4669e">assert</a>((<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a4e1d1b7290f3f0e0cae580aa90012e49">max_fd</a> &gt; 3) &amp;&amp; <span class="stringliteral">&quot;File descriptor list cannot contain the standard IOs.&quot;</span>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Create STDIN descriptor.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="structvfs__file__t.html">vfs_file_t</a> *stdin = <a class="code" href="vfs_8h.html#a103648a7259f3be7ca1f79b3d247359b">vfs_open</a>(<span class="stringliteral">&quot;/proc/video&quot;</span>, <a class="code" href="fcntl_8h.html#a7a68c9ffaac7dbcd652225dd7c06a54b">O_RDONLY</a>, 0);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    stdin-&gt;<a class="code" href="structvfs__file__t.html#a2ff81c7a70dcd649de7e34c29a49e539">count</a>++;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">fd_list</a>[<a class="code" href="vfs_8h.html#afcf80a6d91178952d107ad00b165752b">STDIN_FILENO</a>].<a class="code" href="structvfs__file__descriptor__t.html#a220f786ab67346d6c887facead27c6fa">file_struct</a> = stdin;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">fd_list</a>[<a class="code" href="vfs_8h.html#afcf80a6d91178952d107ad00b165752b">STDIN_FILENO</a>].<a class="code" href="structvfs__file__descriptor__t.html#abbd3d0bdd98801c356854c41773eff12">flags_mask</a>  = <a class="code" href="fcntl_8h.html#a7a68c9ffaac7dbcd652225dd7c06a54b">O_RDONLY</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;`/proc/video` stdin  : %p\n&quot;</span>, stdin);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// Create STDOUT descriptor.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="structvfs__file__t.html">vfs_file_t</a> *stdout = <a class="code" href="vfs_8h.html#a103648a7259f3be7ca1f79b3d247359b">vfs_open</a>(<span class="stringliteral">&quot;/proc/video&quot;</span>, <a class="code" href="fcntl_8h.html#a11b644a8526139c4cc1850dac1271ced">O_WRONLY</a>, 0);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    stdout-&gt;<a class="code" href="structvfs__file__t.html#a2ff81c7a70dcd649de7e34c29a49e539">count</a>++;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">fd_list</a>[<a class="code" href="vfs_8h.html#abd165ee6474b5b75bf075842fff13a04">STDOUT_FILENO</a>].<a class="code" href="structvfs__file__descriptor__t.html#a220f786ab67346d6c887facead27c6fa">file_struct</a> = stdout;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">fd_list</a>[<a class="code" href="vfs_8h.html#abd165ee6474b5b75bf075842fff13a04">STDOUT_FILENO</a>].<a class="code" href="structvfs__file__descriptor__t.html#abbd3d0bdd98801c356854c41773eff12">flags_mask</a>  = <a class="code" href="fcntl_8h.html#a11b644a8526139c4cc1850dac1271ced">O_WRONLY</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;`/proc/video` stdout : %p\n&quot;</span>, stdout);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// Create STDERR descriptor.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="structvfs__file__t.html">vfs_file_t</a> *stderr = <a class="code" href="vfs_8h.html#a103648a7259f3be7ca1f79b3d247359b">vfs_open</a>(<span class="stringliteral">&quot;/proc/video&quot;</span>, <a class="code" href="fcntl_8h.html#a11b644a8526139c4cc1850dac1271ced">O_WRONLY</a>, 0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    stderr-&gt;<a class="code" href="structvfs__file__t.html#a2ff81c7a70dcd649de7e34c29a49e539">count</a>++;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">fd_list</a>[<a class="code" href="vfs_8h.html#ae2fe1725bb5e9823d089c46b9ed5266e">STDERR_FILENO</a>].<a class="code" href="structvfs__file__descriptor__t.html#a220f786ab67346d6c887facead27c6fa">file_struct</a> = stderr;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">fd_list</a>[<a class="code" href="vfs_8h.html#ae2fe1725bb5e9823d089c46b9ed5266e">STDERR_FILENO</a>].<a class="code" href="structvfs__file__descriptor__t.html#abbd3d0bdd98801c356854c41773eff12">flags_mask</a>  = <a class="code" href="fcntl_8h.html#a11b644a8526139c4cc1850dac1271ced">O_WRONLY</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;`/proc/video` stderr : %p\n&quot;</span>, stderr);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// == INITIALIZE TASK MEMORY ==============================================</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// Load the executable.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (!__load_executable(path, <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>, &amp;<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a17c833799d2c9404db4f121c1cae602d">eip</a>)) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;Entry for init: %d\n&quot;</span>, <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a17c833799d2c9404db4f121c1cae602d">eip</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="panic_8h.html#aca2eea7d67ed037ceee4c9879cc439c0">kernel_panic</a>(<span class="stringliteral">&quot;Init not valid (%d)!&quot;</span>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// == INITIALIZE PROGRAM ARGUMENTS ========================================</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// Save the current page directory.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="structpage__directory__t.html">page_directory_t</a> *crtdir = <a class="code" href="paging_8h.html#a53a0eb525b1c0d63f56ea27b671c77f7">paging_get_current_directory</a>();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// Switch to init page directory.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="paging_8h.html#a275110d039474e166124734b3c76e5ea">paging_switch_directory_va</a>(<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a62b4019cc9b1183e0844041b2a587ba1">pgd</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// Prepare argv and envp for the init process.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">char</span> **argv_ptr, **envp_ptr;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">int</span> argc            = 1;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> *argv[] = {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="stringliteral">&quot;/bin/init&quot;</span>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        (<span class="keywordtype">char</span> *)<a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    };</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> *envp[] = {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        (<span class="keywordtype">char</span> *)<a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    };</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// Save where the arguments start.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a52246f1aa4e4c2bea2a348b87e127651">arg_start</a> = <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Push the arguments on the stack.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    argv_ptr = <a class="code" href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">__push_args_on_stack</a>(&amp;<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, argv);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// Save where the arguments end.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a59070ad13bf22a1f293acb8bd509334f">arg_end</a> = <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// Save where the environmental variables start.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a2de788a48c55d244c8f882272b588ab7">env_start</a> = <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// Push the environment on the stack.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    envp_ptr = <a class="code" href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">__push_args_on_stack</a>(&amp;<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, envp);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// Save where the environmental variables end.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a9bb47616aae930bee79c83dd9d5ee0b6">env_end</a> = <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// Push the `main` arguments on the stack (argc, argv, envp).</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, envp_ptr);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, argv_ptr);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, argc);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// Restore previous pgdir</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="paging_8h.html#acb7c264c90dcd844da63c60d4886dab0">paging_switch_directory</a>(crtdir);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// Active the current process.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="scheduler_8h.html#a82dc15cfa1c9d51a929ff643ed0534f7">scheduler_enqueue_task</a>(<a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;Executing &#39;%s&#39; (pid: %d)...\n&quot;</span>, <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>, <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>-&gt;<a class="code" href="structtask__struct.html#afc180f9e1e6ace46019d9560d008b515">pid</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="syscall_8h.html#ac4d4f6bd88e4143d3e9f80e109605ad9">  339</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="process_8c.html#ac4d4f6bd88e4143d3e9f80e109605ad9">sys_getcwd</a>(<span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> size)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="structtask__struct.html">task_struct</a> *current = <a class="code" href="scheduler_8h.html#a53c736a14b056ed715ec0997da894cb3">scheduler_get_current_process</a>();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> ((current != <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (buf != <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="mentos_2src_2klib_2string_8c.html#ac25b4990403370b02ac7f8403a6b3230">strncpy</a>(buf, current-&gt;<a class="code" href="structtask__struct.html#a7c21f2477fef8029c5ffaa7dd9701b66">cwd</a>, size);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">char</span> *)-<a class="code" href="mentos_2inc_2sys_2errno_8h.html#ac2a2e9fa555401f94478f74e01868032">EACCES</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="syscall_8h.html#a9b5215f1f30114761892767cbb00c5d2">  349</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="process_8c.html#a9b5215f1f30114761892767cbb00c5d2">sys_chdir</a>(<span class="keywordtype">char</span> <span class="keyword">const</span> *path)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="structtask__struct.html">task_struct</a> *current = <a class="code" href="scheduler_8h.html#a53c736a14b056ed715ec0997da894cb3">scheduler_get_current_process</a>();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="assert_8h.html#a0041af519e0e7d47c9bcc83760c4669e">assert</a>(current &amp;&amp; <span class="stringliteral">&quot;There is no running process.&quot;</span>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (!path)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="mentos_2inc_2sys_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">char</span> absolute_path[<a class="code" href="limits_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>];</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="mentos_2src_2klib_2libgen_8c.html#a444a66a3083f68ded148883e7b507fc9">realpath</a>(path, absolute_path);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// Check that the directory exists.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="structvfs__file__t.html">vfs_file_t</a> *dir = <a class="code" href="vfs_8h.html#a103648a7259f3be7ca1f79b3d247359b">vfs_open</a>(absolute_path, <a class="code" href="fcntl_8h.html#a7a68c9ffaac7dbcd652225dd7c06a54b">O_RDONLY</a> | <a class="code" href="fcntl_8h.html#a6afd3dd2f570069804b40e6aa24fc966">O_DIRECTORY</a>, <a class="code" href="group__ModeBitsAccessPermission.html#gaf10a35e3950795d6ee4e07157d000131">S_IXUSR</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> (dir) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="mentos_2src_2klib_2string_8c.html#a1a8e0d046aa6ccaf2c9947e3142e4786">strcpy</a>(current-&gt;<a class="code" href="structtask__struct.html#a7c21f2477fef8029c5ffaa7dd9701b66">cwd</a>, absolute_path);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="vfs_8h.html#a6e3812039538e7780756472cdb932086">vfs_close</a>(dir);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// Return the errno value set by either VFS or the filesystem underneath.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="mentos_2inc_2sys_2errno_8h.html#ab03f640d90fbc5bcb75285d08a0f25ed">errno</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="syscall_8h.html#a58569b5c13bd9e4300954e28b138473a">  368</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="process_8c.html#a58569b5c13bd9e4300954e28b138473a">sys_fchdir</a>(<span class="keywordtype">int</span> fd)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="structtask__struct.html">task_struct</a> *current = <a class="code" href="scheduler_8h.html#a53c736a14b056ed715ec0997da894cb3">scheduler_get_current_process</a>();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="assert_8h.html#a0041af519e0e7d47c9bcc83760c4669e">assert</a>(current &amp;&amp; <span class="stringliteral">&quot;There is no running process.&quot;</span>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Check if it is a valid file descriptor.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">if</span> ((fd &lt; 0) || (fd &gt;= current-&gt;<a class="code" href="structtask__struct.html#a4e1d1b7290f3f0e0cae580aa90012e49">max_fd</a>))</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="mentos_2inc_2sys_2errno_8h.html#ac54507d66b43ad12f9356257323c0018">EBADF</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">// Get the file descriptor.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="structvfs__file__descriptor__t.html">vfs_file_descriptor_t</a> *vfd = &amp;current-&gt;<a class="code" href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">fd_list</a>[fd];</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// Check if the file descriptor file is set.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (vfd-&gt;<a class="code" href="structvfs__file__descriptor__t.html#a220f786ab67346d6c887facead27c6fa">file_struct</a> == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="mentos_2inc_2sys_2errno_8h.html#a03e689f378f643d16ea7537918528a48">ENOENT</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// Check that the path points to a directory.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="bitops_8h.html#aa0f8fe9b568b3eb20b763917b3a3dfbb">bitmask_check</a>(vfd-&gt;<a class="code" href="structvfs__file__descriptor__t.html#a220f786ab67346d6c887facead27c6fa">file_struct</a>-&gt;<a class="code" href="structvfs__file__t.html#ad977c810d41b0cbd8a0fe2d25f6e8a31">flags</a>, DT_DIR))</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="mentos_2inc_2sys_2errno_8h.html#a9262fb92f7ef662d0bdd577912a5b101">ENOTDIR</a>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">char</span> absolute_path[<a class="code" href="limits_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>];</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="mentos_2src_2klib_2libgen_8c.html#a444a66a3083f68ded148883e7b507fc9">realpath</a>(vfd-&gt;<a class="code" href="structvfs__file__descriptor__t.html#a220f786ab67346d6c887facead27c6fa">file_struct</a>-&gt;<a class="code" href="structvfs__file__t.html#afe85064c0f0b0a96a543cecd00d7dec3">name</a>, absolute_path);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="mentos_2src_2klib_2string_8c.html#a1a8e0d046aa6ccaf2c9947e3142e4786">strcpy</a>(current-&gt;<a class="code" href="structtask__struct.html#a7c21f2477fef8029c5ffaa7dd9701b66">cwd</a>, absolute_path);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="syscall_8h.html#abfe8a5a73be9d30fcdbf269fa5683f67">  389</a></span>&#160;<a class="code" href="mentos_2inc_2sys_2types_8h.html#a632d205ec0e6c1358e38dce69d918b78">pid_t</a> <a class="code" href="process_8c.html#abfe8a5a73be9d30fcdbf269fa5683f67">sys_fork</a>(<a class="code" href="structpt__regs.html">pt_regs</a> *f)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="structtask__struct.html">task_struct</a> *current = <a class="code" href="scheduler_8h.html#a53c736a14b056ed715ec0997da894cb3">scheduler_get_current_process</a>();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span> (current == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="panic_8h.html#aca2eea7d67ed037ceee4c9879cc439c0">kernel_panic</a>(<span class="stringliteral">&quot;There is no current process!&quot;</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;Forking   &#39;%s&#39; (pid: %d)...\n&quot;</span>, current-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>, current-&gt;<a class="code" href="structtask__struct.html#afc180f9e1e6ace46019d9560d008b515">pid</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// Update current process registers, they should be equal</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// to the ones of the child process, except for eax.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="scheduler_8h.html#a8301969665d4e734ccda347cf026dc18">scheduler_store_context</a>(f, current);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// Allocate the memory for the process.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="structtask__struct.html">task_struct</a> *proc = __alloc_task(current, current, current-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// Copy the father&#39;s stack, memory, heap etc... to the child process</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a> = <a class="code" href="paging_8h.html#a4110424180238ba9a1ec6e2ad586b07e">clone_process_image</a>(current-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// Set the eax as 0, to indicate the child process</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a62e11b5080a51c9642ec1818dd00ebd3">eax</a> = 0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// Enable the interrupts.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#ab98af36ae408b8b40fee6b32f26d1955">eflags</a> = proc-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#ab98af36ae408b8b40fee6b32f26d1955">eflags</a> | <a class="code" href="mentos_2inc_2sys_2types_8h.html#a321a0f206107c6aeee36068c02bb9da5a3ce22e8b74580f9c4b2bfaa163746322">EFLAG_IF</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// Copy session and group id of the parent into the child</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#af87ae9f3a8a1bf7e6333909836d7ae68">sid</a>  = current-&gt;<a class="code" href="structtask__struct.html#af87ae9f3a8a1bf7e6333909836d7ae68">sid</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a604a8ed7213cf3158b0c66ae37cb151b">pgid</a> = current-&gt;<a class="code" href="structtask__struct.html#a604a8ed7213cf3158b0c66ae37cb151b">pgid</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a91a8e2117841c08b1275c47dbf009dbb">uid</a>  = current-&gt;<a class="code" href="structtask__struct.html#a91a8e2117841c08b1275c47dbf009dbb">uid</a>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    proc-&gt;<a class="code" href="structtask__struct.html#a225f2beda1e687c2f1a1219d5eed4264">gid</a>  = current-&gt;<a class="code" href="structtask__struct.html#a225f2beda1e687c2f1a1219d5eed4264">gid</a>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// Active the new process.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="scheduler_8h.html#a82dc15cfa1c9d51a929ff643ed0534f7">scheduler_enqueue_task</a>(proc);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;Forked    &#39;%s&#39; (pid: %d, gid: %d, sid: %d, pgid: %d)...\n&quot;</span>, proc-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>, proc-&gt;<a class="code" href="structtask__struct.html#afc180f9e1e6ace46019d9560d008b515">pid</a>, proc-&gt;<a class="code" href="structtask__struct.html#a225f2beda1e687c2f1a1219d5eed4264">gid</a>, proc-&gt;<a class="code" href="structtask__struct.html#af87ae9f3a8a1bf7e6333909836d7ae68">sid</a>, proc-&gt;<a class="code" href="structtask__struct.html#a604a8ed7213cf3158b0c66ae37cb151b">pgid</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// Return PID of child process to parent.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> proc-&gt;<a class="code" href="structtask__struct.html#afc180f9e1e6ace46019d9560d008b515">pid</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="syscall_8h.html#ad598c24e0e2860e850bd48a217282bd0">  424</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="process_8c.html#ad598c24e0e2860e850bd48a217282bd0">sys_execve</a>(<a class="code" href="structpt__regs.html">pt_regs</a> *f)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;{</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Check the current process.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="structtask__struct.html">task_struct</a> *current = <a class="code" href="scheduler_8h.html#a53c736a14b056ed715ec0997da894cb3">scheduler_get_current_process</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (current == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="panic_8h.html#aca2eea7d67ed037ceee4c9879cc439c0">kernel_panic</a>(<span class="stringliteral">&quot;There is no current process!&quot;</span>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordtype">char</span> **origin_argv, **saved_argv, **final_argv;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">char</span> **origin_envp, **saved_envp, **final_envp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">char</span> name_buffer[<a class="code" href="limits_8h.html#ac64541bdd81c961304b9babef1402640">NAME_MAX</a>];</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// Get the filename.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordtype">char</span> *filename = (<span class="keywordtype">char</span> *)f-&gt;<a class="code" href="structpt__regs.html#a93f56af95cc4ec4c4c32fc78c14cbee2">ebx</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    if (filename == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;Received NULL filename.\n&quot;</span>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// Get the arguments</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    origin_argv = (<span class="keywordtype">char</span> **)f-&gt;<a class="code" href="structpt__regs.html#a22433838655905e9e51b071cdddcf67a">ecx</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// Get the environment.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    origin_envp = (<span class="keywordtype">char</span> **)f-&gt;<a class="code" href="structpt__regs.html#afd15cab97cc4f73329200206c9e60311">edx</a>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// Check the argument, the environment, and that at least the name is provided.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">if</span> (origin_argv == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;sys_execve failed: must provide argv.\n&quot;</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (origin_argv[0] == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;sys_execve failed: must provide the name.\n&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (origin_envp == <a class="code" href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;sys_execve failed: must provide the environment.\n&quot;</span>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// Save the name of the process.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="mentos_2src_2klib_2string_8c.html#a1a8e0d046aa6ccaf2c9947e3142e4786">strcpy</a>(name_buffer, origin_argv[0]);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// == COPY PROGRAM ARGUMENTS ==============================================</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// Copy argv and envp to kernel memory, because all the old process memory will be discarded.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">int</span> argc       = <a class="code" href="process_8c.html#a3de12e2df80906e114483ac212f9a3b4">__count_args</a>(origin_argv);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordtype">int</span> argv_bytes = <a class="code" href="process_8c.html#ab6cda375a61ffc2198644d07c98a1f44">__count_args_bytes</a>(origin_argv);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordtype">int</span> envc       = <a class="code" href="process_8c.html#a3de12e2df80906e114483ac212f9a3b4">__count_args</a>(origin_envp);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">int</span> envp_bytes = <a class="code" href="process_8c.html#ab6cda375a61ffc2198644d07c98a1f44">__count_args_bytes</a>(origin_envp);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> ((argv_bytes &lt; 0) || (envp_bytes &lt; 0)) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;Failed to count required memory to store arguments and environment (%d + %d).\n&quot;</span>,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;               argv_bytes, envp_bytes);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">void</span> *args_mem = <a class="code" href="slab_8h.html#a6d6d6d860a3dd67eb762ee84a2a8368c">kmalloc</a>(argv_bytes + envp_bytes);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (!args_mem) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;Failed to allocate memory for arguments and environment %d (%d + %d).\n&quot;</span>,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;               argv_bytes + envp_bytes, argv_bytes, envp_bytes);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// Copy the arguments.</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> args_mem_ptr = (<a class="code" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)args_mem + (argv_bytes + envp_bytes);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    saved_argv            = <a class="code" href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">__push_args_on_stack</a>(&amp;args_mem_ptr, origin_argv);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    saved_envp            = <a class="code" href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">__push_args_on_stack</a>(&amp;args_mem_ptr, origin_envp);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// Check the memory pointer.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="assert_8h.html#a0041af519e0e7d47c9bcc83760c4669e">assert</a>(args_mem_ptr == (<a class="code" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)args_mem);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// == INITIALIZE TASK MEMORY ==============================================</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> (!__load_executable(filename, current, &amp;current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a17c833799d2c9404db4f121c1cae602d">eip</a>)) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <a class="code" href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a>(<span class="stringliteral">&quot;Failed to load executable!\n&quot;</span>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="comment">// Free the temporary args memory.</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="slab_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a>(args_mem);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// == INITIALIZE PROGRAM ARGUMENTS ========================================</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// Save the current page directory.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="structpage__directory__t.html">page_directory_t</a> *crtdir = <a class="code" href="paging_8h.html#a53a0eb525b1c0d63f56ea27b671c77f7">paging_get_current_directory</a>();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">// Change the page directory to point to the newly created process</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="paging_8h.html#a275110d039474e166124734b3c76e5ea">paging_switch_directory_va</a>(current-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a62b4019cc9b1183e0844041b2a587ba1">pgd</a>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// Save where the arguments start.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    current-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a52246f1aa4e4c2bea2a348b87e127651">arg_start</a> = current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">// Push the arguments on the stack.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    final_argv = <a class="code" href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">__push_args_on_stack</a>(&amp;current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, saved_argv);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// Save where the arguments end, and the env starts.</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    current-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a2de788a48c55d244c8f882272b588ab7">env_start</a> = current-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a59070ad13bf22a1f293acb8bd509334f">arg_end</a> = current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// Push the environment on the stack.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    final_envp = <a class="code" href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">__push_args_on_stack</a>(&amp;current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, saved_envp);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// Save where the environmental variables end.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    current-&gt;<a class="code" href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">mm</a>-&gt;<a class="code" href="structmm__struct__t.html#a9bb47616aae930bee79c83dd9d5ee0b6">env_end</a> = current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// Push the `main` arguments on the stack (argc, argv, envp).</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, final_envp);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, final_argv);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a>(current-&gt;<a class="code" href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">thread</a>.<a class="code" href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">regs</a>.<a class="code" href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">useresp</a>, argc);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// Restore previous pgdir</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="paging_8h.html#acb7c264c90dcd844da63c60d4886dab0">paging_switch_directory</a>(crtdir);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// Change the name of the process.</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="mentos_2src_2klib_2string_8c.html#a1a8e0d046aa6ccaf2c9947e3142e4786">strcpy</a>(current-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>, name_buffer);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// Free the temporary args memory.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="slab_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a>(args_mem);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// Perform the switch to the new process.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="scheduler_8h.html#a58b8f367f778e3a81762789b96d97d16">scheduler_restore_context</a>(current, f);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a>(<span class="stringliteral">&quot;Executing &#39;%s&#39; (pid: %d)...\n&quot;</span>, current-&gt;<a class="code" href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">name</a>, current-&gt;<a class="code" href="structtask__struct.html#afc180f9e1e6ace46019d9560d008b515">pid</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div>
<div class="ttc" id="aassert_8h_html"><div class="ttname"><a href="assert_8h.html">assert.h</a></div><div class="ttdoc">Defines the function and pre-processor macro for assertions.</div></div>
<div class="ttc" id="aassert_8h_html_a0041af519e0e7d47c9bcc83760c4669e"><div class="ttname"><a href="assert_8h.html#a0041af519e0e7d47c9bcc83760c4669e">assert</a></div><div class="ttdeci">#define assert(expression)</div><div class="ttdoc">Assert function.</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00019">assert.h:19</a></div></div>
<div class="ttc" id="abitops_8h_html_aa0f8fe9b568b3eb20b763917b3a3dfbb"><div class="ttname"><a href="bitops_8h.html#aa0f8fe9b568b3eb20b763917b3a3dfbb">bitmask_check</a></div><div class="ttdeci">#define bitmask_check(V, M)</div><div class="ttdoc">Checks if the bits identified by the mask are all 1.</div><div class="ttdef"><b>Definition:</b> <a href="bitops_8h_source.html#l00022">bitops.h:22</a></div></div>
<div class="ttc" id="aelf_8h_html"><div class="ttname"><a href="elf_8h.html">elf.h</a></div><div class="ttdoc">Function for managing the Executable and Linkable Format (ELF).</div></div>
<div class="ttc" id="aelf_8h_html_a6f4c944f618ecde6500a1dae657f62cd"><div class="ttname"><a href="elf_8h.html#a6f4c944f618ecde6500a1dae657f62cd">elf_check_file_type</a></div><div class="ttdeci">int elf_check_file_type(vfs_file_t *file, Elf_Type type)</div><div class="ttdoc">Checks if the file is a valid ELF.</div><div class="ttdef"><b>Definition:</b> <a href="elf_8c_source.html#l00318">elf.c:318</a></div></div>
<div class="ttc" id="aelf_8h_html_aca03bad05548bf29e58fac485fdd2804"><div class="ttname"><a href="elf_8h.html#aca03bad05548bf29e58fac485fdd2804">elf_load_file</a></div><div class="ttdeci">int elf_load_file(task_struct *task, vfs_file_t *file, uint32_t *entry)</div><div class="ttdoc">Loads an ELF file into the memory of task.</div><div class="ttdef"><b>Definition:</b> <a href="elf_8c_source.html#l00261">elf.c:261</a></div></div>
<div class="ttc" id="aelf_8h_html_ae705110a6320d7ca1cd35cf11ecabde3aff80e596d1ea270d3913f3b2307e3e2b"><div class="ttname"><a href="elf_8h.html#ae705110a6320d7ca1cd35cf11ecabde3aff80e596d1ea270d3913f3b2307e3e2b">ET_EXEC</a></div><div class="ttdeci">@ ET_EXEC</div><div class="ttdoc">Executable File.</div><div class="ttdef"><b>Definition:</b> <a href="elf_8h_source.html#l00207">elf.h:206</a></div></div>
<div class="ttc" id="afcntl_8h_html"><div class="ttname"><a href="fcntl_8h.html">fcntl.h</a></div><div class="ttdoc">Headers of functions fcntl() and open().</div></div>
<div class="ttc" id="afcntl_8h_html_a11b644a8526139c4cc1850dac1271ced"><div class="ttname"><a href="fcntl_8h.html#a11b644a8526139c4cc1850dac1271ced">O_WRONLY</a></div><div class="ttdeci">#define O_WRONLY</div><div class="ttdoc">Open for writing only.</div><div class="ttdef"><b>Definition:</b> <a href="fcntl_8h_source.html#l00009">fcntl.h:9</a></div></div>
<div class="ttc" id="afcntl_8h_html_a6afd3dd2f570069804b40e6aa24fc966"><div class="ttname"><a href="fcntl_8h.html#a6afd3dd2f570069804b40e6aa24fc966">O_DIRECTORY</a></div><div class="ttdeci">#define O_DIRECTORY</div><div class="ttdoc">If file exists has no effect. Otherwise, the file is created.</div><div class="ttdef"><b>Definition:</b> <a href="fcntl_8h_source.html#l00016">fcntl.h:16</a></div></div>
<div class="ttc" id="afcntl_8h_html_a7a68c9ffaac7dbcd652225dd7c06a54b"><div class="ttname"><a href="fcntl_8h.html#a7a68c9ffaac7dbcd652225dd7c06a54b">O_RDONLY</a></div><div class="ttdeci">#define O_RDONLY</div><div class="ttdoc">Open for reading only.</div><div class="ttdef"><b>Definition:</b> <a href="fcntl_8h_source.html#l00008">fcntl.h:8</a></div></div>
<div class="ttc" id="agroup__ModeBitsAccessPermission_html_gaf10a35e3950795d6ee4e07157d000131"><div class="ttname"><a href="group__ModeBitsAccessPermission.html#gaf10a35e3950795d6ee4e07157d000131">S_IXUSR</a></div><div class="ttdeci">#define S_IXUSR</div><div class="ttdoc">—x---— : User can execute</div><div class="ttdef"><b>Definition:</b> <a href="fcntl_8h_source.html#l00028">fcntl.h:28</a></div></div>
<div class="ttc" id="agroup__gfp__flag__combinations_html_ga44b9e863fd60efc9018a5524b77532ee"><div class="ttname"><a href="group__gfp__flag__combinations.html#ga44b9e863fd60efc9018a5524b77532ee">GFP_KERNEL</a></div><div class="ttdeci">#define GFP_KERNEL</div><div class="ttdoc">is typical for kernel-internal allocations. The caller requires ZONE_NORMAL or a lower zone for direc...</div><div class="ttdef"><b>Definition:</b> <a href="gfp_8h_source.html#l00109">gfp.h:109</a></div></div>
<div class="ttc" id="akernel__levels_8h_html"><div class="ttname"><a href="kernel__levels_8h.html">kernel_levels.h</a></div></div>
<div class="ttc" id="alibgen_8h_html"><div class="ttname"><a href="libgen_8h.html">libgen.h</a></div><div class="ttdoc">String routines.</div></div>
<div class="ttc" id="alimits_8h_html_ac64541bdd81c961304b9babef1402640"><div class="ttname"><a href="limits_8h.html#ac64541bdd81c961304b9babef1402640">NAME_MAX</a></div><div class="ttdeci">#define NAME_MAX</div><div class="ttdoc">Maximum number of characters in a file name.</div><div class="ttdef"><b>Definition:</b> <a href="limits_8h_source.html#l00051">limits.h:51</a></div></div>
<div class="ttc" id="alimits_8h_html_ae688d728e1acdfe5988c7db45d6f0166"><div class="ttname"><a href="limits_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a></div><div class="ttdeci">#define PATH_MAX</div><div class="ttdoc">Maximum number of characters in a path name.</div><div class="ttdef"><b>Definition:</b> <a href="limits_8h_source.html#l00054">limits.h:54</a></div></div>
<div class="ttc" id="alist__head_8h_html_a1d8fce796637606fb5366d7edc076cd3"><div class="ttname"><a href="list__head_8h.html#a1d8fce796637606fb5366d7edc076cd3">list_head_init</a></div><div class="ttdeci">static void list_head_init(list_head *head)</div><div class="ttdoc">Initializes the list_head.</div><div class="ttdef"><b>Definition:</b> <a href="list__head_8h_source.html#l00052">list_head.h:52</a></div></div>
<div class="ttc" id="alist__head_8h_html_a6cacd6ad6863aae47561df20604bdcac"><div class="ttname"><a href="list__head_8h.html#a6cacd6ad6863aae47561df20604bdcac">list_head_insert_before</a></div><div class="ttdeci">static void list_head_insert_before(list_head *new_entry, list_head *location)</div><div class="ttdoc">Insert the new entry before the given location.</div><div class="ttdef"><b>Definition:</b> <a href="list__head_8h_source.html#l00095">list_head.h:95</a></div></div>
<div class="ttc" id="amentos_2inc_2io_2debug_8h_html"><div class="ttname"><a href="mentos_2inc_2io_2debug_8h.html">debug.h</a></div><div class="ttdoc">Debugging primitives.</div></div>
<div class="ttc" id="amentos_2inc_2io_2debug_8h_html_ac90110f7b4f2db466dd7a1d164c866f5"><div class="ttname"><a href="mentos_2inc_2io_2debug_8h.html#ac90110f7b4f2db466dd7a1d164c866f5">pr_debug</a></div><div class="ttdeci">#define pr_debug(...)</div><div class="ttdoc">Prints a KERN_DEBUG.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2io_2debug_8h_source.html#l00111">debug.h:111</a></div></div>
<div class="ttc" id="amentos_2inc_2io_2debug_8h_html_aff10e9b3594e088ce07388ca38c89496"><div class="ttname"><a href="mentos_2inc_2io_2debug_8h.html#aff10e9b3594e088ce07388ca38c89496">pr_err</a></div><div class="ttdeci">#define pr_err(...)</div><div class="ttdoc">Prints a KERN_ERR.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2io_2debug_8h_source.html#l00087">debug.h:87</a></div></div>
<div class="ttc" id="amentos_2inc_2process_2wait_8h_html"><div class="ttname"><a href="mentos_2inc_2process_2wait_8h.html">wait.h</a></div></div>
<div class="ttc" id="amentos_2inc_2process_2wait_8h_html_a17e3f99a030e5dfefb8f9815600e3fed"><div class="ttname"><a href="mentos_2inc_2process_2wait_8h.html#a17e3f99a030e5dfefb8f9815600e3fed">TASK_RUNNING</a></div><div class="ttdeci">#define TASK_RUNNING</div><div class="ttdoc">The process is either: 1) running on CPU or 2) waiting in a run queue.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2process_2wait_8h_source.html#l00040">wait.h:40</a></div></div>
<div class="ttc" id="amentos_2inc_2sys_2errno_8h_html_a03e689f378f643d16ea7537918528a48"><div class="ttname"><a href="mentos_2inc_2sys_2errno_8h.html#a03e689f378f643d16ea7537918528a48">ENOENT</a></div><div class="ttdeci">#define ENOENT</div><div class="ttdoc">No such file or directory.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2sys_2errno_8h_source.html#l00014">errno.h:14</a></div></div>
<div class="ttc" id="amentos_2inc_2sys_2errno_8h_html_a3f317946e043623f9d6b93dbf60e6316"><div class="ttname"><a href="mentos_2inc_2sys_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a></div><div class="ttdeci">#define EFAULT</div><div class="ttdoc">Bad address.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2sys_2errno_8h_source.html#l00026">errno.h:26</a></div></div>
<div class="ttc" id="amentos_2inc_2sys_2errno_8h_html_a9262fb92f7ef662d0bdd577912a5b101"><div class="ttname"><a href="mentos_2inc_2sys_2errno_8h.html#a9262fb92f7ef662d0bdd577912a5b101">ENOTDIR</a></div><div class="ttdeci">#define ENOTDIR</div><div class="ttdoc">Not a directory.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2sys_2errno_8h_source.html#l00032">errno.h:32</a></div></div>
<div class="ttc" id="amentos_2inc_2sys_2errno_8h_html_ab03f640d90fbc5bcb75285d08a0f25ed"><div class="ttname"><a href="mentos_2inc_2sys_2errno_8h.html#ab03f640d90fbc5bcb75285d08a0f25ed">errno</a></div><div class="ttdeci">#define errno</div><div class="ttdoc">Provide easy access to the error number.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2sys_2errno_8h_source.html#l00011">errno.h:11</a></div></div>
<div class="ttc" id="amentos_2inc_2sys_2errno_8h_html_ac2a2e9fa555401f94478f74e01868032"><div class="ttname"><a href="mentos_2inc_2sys_2errno_8h.html#ac2a2e9fa555401f94478f74e01868032">EACCES</a></div><div class="ttdeci">#define EACCES</div><div class="ttdoc">Permission denied.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2sys_2errno_8h_source.html#l00025">errno.h:25</a></div></div>
<div class="ttc" id="amentos_2inc_2sys_2errno_8h_html_ac54507d66b43ad12f9356257323c0018"><div class="ttname"><a href="mentos_2inc_2sys_2errno_8h.html#ac54507d66b43ad12f9356257323c0018">EBADF</a></div><div class="ttdeci">#define EBADF</div><div class="ttdoc">Bad file number.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2sys_2errno_8h_source.html#l00021">errno.h:21</a></div></div>
<div class="ttc" id="amentos_2inc_2sys_2types_8h_html_a321a0f206107c6aeee36068c02bb9da5a3ce22e8b74580f9c4b2bfaa163746322"><div class="ttname"><a href="mentos_2inc_2sys_2types_8h.html#a321a0f206107c6aeee36068c02bb9da5a3ce22e8b74580f9c4b2bfaa163746322">EFLAG_IF</a></div><div class="ttdeci">@ EFLAG_IF</div><div class="ttdoc">Interrupt enable flag.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2sys_2types_8h_source.html#l00041">types.h:41</a></div></div>
<div class="ttc" id="amentos_2inc_2sys_2types_8h_html_a632d205ec0e6c1358e38dce69d918b78"><div class="ttname"><a href="mentos_2inc_2sys_2types_8h.html#a632d205ec0e6c1358e38dce69d918b78">pid_t</a></div><div class="ttdeci">signed int pid_t</div><div class="ttdoc">The type of process id.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2sys_2types_8h_source.html#l00009">types.h:9</a></div></div>
<div class="ttc" id="amentos_2inc_2system_2signal_8h_html_a27d5dc561093d6243542e6a2465bc0f8"><div class="ttname"><a href="mentos_2inc_2system_2signal_8h.html#a27d5dc561093d6243542e6a2465bc0f8">SIG_DFL</a></div><div class="ttdeci">#define SIG_DFL</div><div class="ttdoc">Default signal handling.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00156">signal.h:156</a></div></div>
<div class="ttc" id="amentos_2inc_2system_2signal_8h_html_a5925352f90eb589393274fa0376d7def"><div class="ttname"><a href="mentos_2inc_2system_2signal_8h.html#a5925352f90eb589393274fa0376d7def">sigemptyset</a></div><div class="ttdeci">int sigemptyset(sigset_t *set)</div><div class="ttdoc">Prepare an empty set.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2src_2system_2signal_8c_source.html#l00765">signal.c:765</a></div></div>
<div class="ttc" id="amentos_2src_2klib_2libgen_8c_html_a444a66a3083f68ded148883e7b507fc9"><div class="ttname"><a href="mentos_2src_2klib_2libgen_8c.html#a444a66a3083f68ded148883e7b507fc9">realpath</a></div><div class="ttdeci">char * realpath(const char *path, char *resolved)</div><div class="ttdoc">Return the canonicalized absolute pathname.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2src_2klib_2libgen_8c_source.html#l00078">libgen.c:78</a></div></div>
<div class="ttc" id="amentos_2src_2klib_2string_8c_html_a1a8e0d046aa6ccaf2c9947e3142e4786"><div class="ttname"><a href="mentos_2src_2klib_2string_8c.html#a1a8e0d046aa6ccaf2c9947e3142e4786">strcpy</a></div><div class="ttdeci">char * strcpy(char *dst, const char *src)</div><div class="ttdoc">Copy the string src into the array dst.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2src_2klib_2string_8c_source.html#l00441">string.c:441</a></div></div>
<div class="ttc" id="amentos_2src_2klib_2string_8c_html_a37562939be846210ce0560a6168cd7f1"><div class="ttname"><a href="mentos_2src_2klib_2string_8c.html#a37562939be846210ce0560a6168cd7f1">memcpy</a></div><div class="ttdeci">void * memcpy(void *dst, const void *src, size_t num)</div><div class="ttdoc">Copy a block of memory, handling overlap.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2src_2klib_2string_8c_source.html#l00419">string.c:419</a></div></div>
<div class="ttc" id="amentos_2src_2klib_2string_8c_html_a4cb469bec7b722064b97a406346acb61"><div class="ttname"><a href="mentos_2src_2klib_2string_8c.html#a4cb469bec7b722064b97a406346acb61">memset</a></div><div class="ttdeci">void * memset(void *ptr, int value, size_t num)</div><div class="ttdoc">Sets the first num bytes of the block of memory pointed by ptr to the specified value.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2src_2klib_2string_8c_source.html#l00390">string.c:390</a></div></div>
<div class="ttc" id="amentos_2src_2klib_2string_8c_html_aa383452fe445bfae989358c9d7d96f4f"><div class="ttname"><a href="mentos_2src_2klib_2string_8c.html#aa383452fe445bfae989358c9d7d96f4f">strlen</a></div><div class="ttdeci">size_t strlen(const char *s)</div><div class="ttdoc">Returns the length of the string s.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2src_2klib_2string_8c_source.html#l00450">string.c:450</a></div></div>
<div class="ttc" id="amentos_2src_2klib_2string_8c_html_ac25b4990403370b02ac7f8403a6b3230"><div class="ttname"><a href="mentos_2src_2klib_2string_8c.html#ac25b4990403370b02ac7f8403a6b3230">strncpy</a></div><div class="ttdeci">char * strncpy(char *destination, const char *source, size_t num)</div><div class="ttdoc">Copies the first num characters of source to destination.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2src_2klib_2string_8c_source.html#l00012">string.c:12</a></div></div>
<div class="ttc" id="apaging_8h_html_a012755fb79dfee593f8eab6559fc7c3e"><div class="ttname"><a href="paging_8h.html#a012755fb79dfee593f8eab6559fc7c3e">create_blank_process_image</a></div><div class="ttdeci">mm_struct_t * create_blank_process_image(size_t stack_size)</div><div class="ttdoc">Creates the main memory descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00510">paging.c:510</a></div></div>
<div class="ttc" id="apaging_8h_html_a195bae4ec2a8ec60d1bb1c1d66a44c80"><div class="ttname"><a href="paging_8h.html#a195bae4ec2a8ec60d1bb1c1d66a44c80">destroy_process_image</a></div><div class="ttdeci">void destroy_process_image(mm_struct_t *mm)</div><div class="ttdoc">Free Memory Descriptor with all the memory segment contained.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00569">paging.c:569</a></div></div>
<div class="ttc" id="apaging_8h_html_a275110d039474e166124734b3c76e5ea"><div class="ttname"><a href="paging_8h.html#a275110d039474e166124734b3c76e5ea">paging_switch_directory_va</a></div><div class="ttdeci">void paging_switch_directory_va(page_directory_t *dir)</div><div class="ttdoc">Switches paging directory, the pointer can be a lowmem address.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00063">paging.c:63</a></div></div>
<div class="ttc" id="apaging_8h_html_a4110424180238ba9a1ec6e2ad586b07e"><div class="ttname"><a href="paging_8h.html#a4110424180238ba9a1ec6e2ad586b07e">clone_process_image</a></div><div class="ttdeci">mm_struct_t * clone_process_image(mm_struct_t *mmp)</div><div class="ttdoc">Create a Memory Descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00535">paging.c:535</a></div></div>
<div class="ttc" id="apaging_8h_html_a53a0eb525b1c0d63f56ea27b671c77f7"><div class="ttname"><a href="paging_8h.html#a53a0eb525b1c0d63f56ea27b671c77f7">paging_get_current_directory</a></div><div class="ttdeci">static page_directory_t * paging_get_current_directory()</div><div class="ttdoc">Provide access to the current paging directory.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00149">paging.h:149</a></div></div>
<div class="ttc" id="apaging_8h_html_acb7c264c90dcd844da63c60d4886dab0"><div class="ttname"><a href="paging_8h.html#acb7c264c90dcd844da63c60d4886dab0">paging_switch_directory</a></div><div class="ttdeci">static void paging_switch_directory(page_directory_t *dir)</div><div class="ttdoc">Switches paging directory, the pointer must be a physical address.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00156">paging.h:156</a></div></div>
<div class="ttc" id="apanic_8h_html"><div class="ttname"><a href="panic_8h.html">panic.h</a></div><div class="ttdoc">Functions used to manage kernel panic.</div></div>
<div class="ttc" id="apanic_8h_html_aca2eea7d67ed037ceee4c9879cc439c0"><div class="ttname"><a href="panic_8h.html#aca2eea7d67ed037ceee4c9879cc439c0">kernel_panic</a></div><div class="ttdeci">void kernel_panic(const char *msg)</div><div class="ttdoc">Prints the given message and then safely stop the execution of the kernel.</div><div class="ttdef"><b>Definition:</b> <a href="panic_8c_source.html#l00009">panic.c:9</a></div></div>
<div class="ttc" id="aprio_8h_html"><div class="ttname"><a href="prio_8h.html">prio.h</a></div><div class="ttdoc">Defines processes priority value.</div></div>
<div class="ttc" id="aprio_8h_html_a0cbf26ad705a078d6a1ac13555630ccc"><div class="ttname"><a href="prio_8h.html#a0cbf26ad705a078d6a1ac13555630ccc">DEFAULT_PRIO</a></div><div class="ttdeci">#define DEFAULT_PRIO</div><div class="ttdoc">Default priority.</div><div class="ttdef"><b>Definition:</b> <a href="prio_8h_source.html#l00033">prio.h:33</a></div></div>
<div class="ttc" id="aprocess_8c_html_a12e0316d44416bfe809d434edfb2ac16"><div class="ttname"><a href="process_8c.html#a12e0316d44416bfe809d434edfb2ac16">init_tasking</a></div><div class="ttdeci">int init_tasking()</div><div class="ttdoc">Initialize the task management.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00245">process.c:245</a></div></div>
<div class="ttc" id="aprocess_8c_html_a360b960e9d73f0b087cbd05790218aa9"><div class="ttname"><a href="process_8c.html#a360b960e9d73f0b087cbd05790218aa9">task_struct_cache</a></div><div class="ttdeci">static kmem_cache_t * task_struct_cache</div><div class="ttdoc">Cache for creating the task structs.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00030">process.c:30</a></div></div>
<div class="ttc" id="aprocess_8c_html_a3de12e2df80906e114483ac212f9a3b4"><div class="ttname"><a href="process_8c.html#a3de12e2df80906e114483ac212f9a3b4">__count_args</a></div><div class="ttdeci">static int __count_args(char **args)</div><div class="ttdoc">Counts the number of arguments.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00037">process.c:37</a></div></div>
<div class="ttc" id="aprocess_8c_html_a4435a6322e406ac1eba8fbe225c52877"><div class="ttname"><a href="process_8c.html#a4435a6322e406ac1eba8fbe225c52877">process_create_init</a></div><div class="ttdeci">task_struct * process_create_init(const char *path)</div><div class="ttdoc">Create and spawn the init process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00253">process.c:253</a></div></div>
<div class="ttc" id="aprocess_8c_html_a58569b5c13bd9e4300954e28b138473a"><div class="ttname"><a href="process_8c.html#a58569b5c13bd9e4300954e28b138473a">sys_fchdir</a></div><div class="ttdeci">int sys_fchdir(int fd)</div><div class="ttdoc">Changes the working directory.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00368">process.c:368</a></div></div>
<div class="ttc" id="aprocess_8c_html_a9b5215f1f30114761892767cbb00c5d2"><div class="ttname"><a href="process_8c.html#a9b5215f1f30114761892767cbb00c5d2">sys_chdir</a></div><div class="ttdeci">int sys_chdir(char const *path)</div><div class="ttdoc">Changes the working directory.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00349">process.c:349</a></div></div>
<div class="ttc" id="aprocess_8c_html_ab6cda375a61ffc2198644d07c98a1f44"><div class="ttname"><a href="process_8c.html#ab6cda375a61ffc2198644d07c98a1f44">__count_args_bytes</a></div><div class="ttdeci">static int __count_args_bytes(char **args)</div><div class="ttdoc">Counts the bytes occupied by the arguments.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00048">process.c:48</a></div></div>
<div class="ttc" id="aprocess_8c_html_abfe8a5a73be9d30fcdbf269fa5683f67"><div class="ttname"><a href="process_8c.html#abfe8a5a73be9d30fcdbf269fa5683f67">sys_fork</a></div><div class="ttdeci">pid_t sys_fork(pt_regs *f)</div><div class="ttdoc">Clone the calling process, but without copying the whole address space. The calling process is suspen...</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00389">process.c:389</a></div></div>
<div class="ttc" id="aprocess_8c_html_ac4d4f6bd88e4143d3e9f80e109605ad9"><div class="ttname"><a href="process_8c.html#ac4d4f6bd88e4143d3e9f80e109605ad9">sys_getcwd</a></div><div class="ttdeci">char * sys_getcwd(char *buf, size_t size)</div><div class="ttdoc">Get current working directory.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00339">process.c:339</a></div></div>
<div class="ttc" id="aprocess_8c_html_ac7d34dca0271a77927ccfb74bdc27404"><div class="ttname"><a href="process_8c.html#ac7d34dca0271a77927ccfb74bdc27404">init_proc</a></div><div class="ttdeci">static task_struct * init_proc</div><div class="ttdoc">The task_struct of the init process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00032">process.c:32</a></div></div>
<div class="ttc" id="aprocess_8c_html_ad37bf2a03cf9aa2bc0492ac46e83db38"><div class="ttname"><a href="process_8c.html#ad37bf2a03cf9aa2bc0492ac46e83db38">__push_args_on_stack</a></div><div class="ttdeci">static char ** __push_args_on_stack(uintptr_t *stack, char *args[])</div><div class="ttdoc">Pushes the arguments on the stack.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00064">process.c:64</a></div></div>
<div class="ttc" id="aprocess_8c_html_ad598c24e0e2860e850bd48a217282bd0"><div class="ttname"><a href="process_8c.html#ad598c24e0e2860e850bd48a217282bd0">sys_execve</a></div><div class="ttdeci">int sys_execve(pt_regs *f)</div><div class="ttdoc">Replaces the current process image with a new process image.</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00424">process.c:424</a></div></div>
<div class="ttc" id="aprocess_8h_html"><div class="ttname"><a href="process_8h.html">process.h</a></div><div class="ttdoc">Process data structures and functions.</div></div>
<div class="ttc" id="aprocess_8h_html_a87dcbc4991a2a2fc4eb6fc6a24449f26"><div class="ttname"><a href="process_8h.html#a87dcbc4991a2a2fc4eb6fc6a24449f26">DEFAULT_STACK_SIZE</a></div><div class="ttdeci">#define DEFAULT_STACK_SIZE</div><div class="ttdoc">The default dimension of the stack of a process (1 MByte).</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00018">process.h:18</a></div></div>
<div class="ttc" id="ascheduler_8h_html"><div class="ttname"><a href="scheduler_8h.html">scheduler.h</a></div><div class="ttdoc">Scheduler structures and functions.</div></div>
<div class="ttc" id="ascheduler_8h_html_a53c736a14b056ed715ec0997da894cb3"><div class="ttname"><a href="scheduler_8h.html#a53c736a14b056ed715ec0997da894cb3">scheduler_get_current_process</a></div><div class="ttdeci">task_struct * scheduler_get_current_process()</div><div class="ttdoc">Returns the pointer to the current active process.</div><div class="ttdef"><b>Definition:</b> <a href="scheduler_8c_source.html#l00060">scheduler.c:60</a></div></div>
<div class="ttc" id="ascheduler_8h_html_a58b8f367f778e3a81762789b96d97d16"><div class="ttname"><a href="scheduler_8h.html#a58b8f367f778e3a81762789b96d97d16">scheduler_restore_context</a></div><div class="ttdeci">void scheduler_restore_context(task_struct *process, pt_regs *f)</div><div class="ttdoc">Values from task_struct process to pt_regs.</div><div class="ttdef"><b>Definition:</b> <a href="scheduler_8c_source.html#l00185">scheduler.c:185</a></div></div>
<div class="ttc" id="ascheduler_8h_html_a82dc15cfa1c9d51a929ff643ed0534f7"><div class="ttname"><a href="scheduler_8h.html#a82dc15cfa1c9d51a929ff643ed0534f7">scheduler_enqueue_task</a></div><div class="ttdeci">void scheduler_enqueue_task(task_struct *process)</div><div class="ttdoc">Activate the given process.</div><div class="ttdef"><b>Definition:</b> <a href="scheduler_8c_source.html#l00104">scheduler.c:104</a></div></div>
<div class="ttc" id="ascheduler_8h_html_a8301969665d4e734ccda347cf026dc18"><div class="ttname"><a href="scheduler_8h.html#a8301969665d4e734ccda347cf026dc18">scheduler_store_context</a></div><div class="ttdeci">void scheduler_store_context(pt_regs *f, task_struct *process)</div><div class="ttdoc">Values from pt_regs to task_struct process.</div><div class="ttdef"><b>Definition:</b> <a href="scheduler_8c_source.html#l00179">scheduler.c:179</a></div></div>
<div class="ttc" id="ascheduler_8h_html_aa988c36c45404bc72d2d484af3453af5"><div class="ttname"><a href="scheduler_8h.html#aa988c36c45404bc72d2d484af3453af5">scheduler_getpid</a></div><div class="ttdeci">uint32_t scheduler_getpid()</div><div class="ttdoc">Returns a non-decreasing unique process id.</div><div class="ttdef"><b>Definition:</b> <a href="scheduler_8c_source.html#l00051">scheduler.c:51</a></div></div>
<div class="ttc" id="aslab_8h_html_a069f85a5001d71bc44d8be6532a4e432"><div class="ttname"><a href="slab_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a></div><div class="ttdeci">void kfree(void *ptr)</div><div class="ttdoc">Frees dynamically allocated memory in kernel space.</div><div class="ttdef"><b>Definition:</b> <a href="slab_8c_source.html#l00343">slab.c:343</a></div></div>
<div class="ttc" id="aslab_8h_html_a1d06cf91e5fab6317cd5a704007f1871"><div class="ttname"><a href="slab_8h.html#a1d06cf91e5fab6317cd5a704007f1871">kmem_cache_alloc</a></div><div class="ttdeci">void * kmem_cache_alloc(kmem_cache_t *cachep, gfp_t flags)</div><div class="ttdoc">Allocs a new object using the provided cache.</div><div class="ttdef"><b>Definition:</b> <a href="slab_8c_source.html#l00234">slab.c:234</a></div></div>
<div class="ttc" id="aslab_8h_html_a6d6d6d860a3dd67eb762ee84a2a8368c"><div class="ttname"><a href="slab_8h.html#a6d6d6d860a3dd67eb762ee84a2a8368c">kmalloc</a></div><div class="ttdeci">void * kmalloc(unsigned int size)</div><div class="ttdoc">Provides dynamically allocated memory in kernel space.</div><div class="ttdef"><b>Definition:</b> <a href="slab_8c_source.html#l00318">slab.c:318</a></div></div>
<div class="ttc" id="aslab_8h_html_ac47373f9f4512eda4e3a27eb262485b3"><div class="ttname"><a href="slab_8h.html#ac47373f9f4512eda4e3a27eb262485b3">KMEM_CREATE</a></div><div class="ttdeci">#define KMEM_CREATE(objtype)</div><div class="ttdoc">Create a new cache.</div><div class="ttdef"><b>Definition:</b> <a href="slab_8h_source.html#l00016">slab.h:16</a></div></div>
<div class="ttc" id="aspinlock_8h_html_a2749c4e36328ae3aca1ea05e4002d940"><div class="ttname"><a href="spinlock_8h.html#a2749c4e36328ae3aca1ea05e4002d940">spinlock_init</a></div><div class="ttdeci">void spinlock_init(spinlock_t *spinlock)</div><div class="ttdoc">Initialize the spinlock.</div><div class="ttdef"><b>Definition:</b> <a href="spinlock_8c_source.html#l00008">spinlock.c:8</a></div></div>
<div class="ttc" id="astack__helper_8h_html"><div class="ttname"><a href="stack__helper_8h.html">stack_helper.h</a></div><div class="ttdoc">Couple of macros that help accessing the stack.</div></div>
<div class="ttc" id="astack__helper_8h_html_a00509e8c838b320fb820c1d9c39e13fa"><div class="ttname"><a href="stack__helper_8h.html#a00509e8c838b320fb820c1d9c39e13fa">PUSH_VALUE_ON_STACK</a></div><div class="ttdeci">#define PUSH_VALUE_ON_STACK(ptr, value)</div><div class="ttdoc">First, it moves the pointer down, and then it pushes the value at that memory location.</div><div class="ttdef"><b>Definition:</b> <a href="stack__helper_8h_source.html#l00015">stack_helper.h:15</a></div></div>
<div class="ttc" id="astdatomic_8h_html_a25e8927e307eceed0b2a83b86b7e62d0"><div class="ttname"><a href="stdatomic_8h.html#a25e8927e307eceed0b2a83b86b7e62d0">atomic_set</a></div><div class="ttdeci">static void atomic_set(atomic_t *ptr, int32_t i)</div><div class="ttdoc">Atomically set ptr equal to i.</div><div class="ttdef"><b>Definition:</b> <a href="stdatomic_8h_source.html#l00046">stdatomic.h:46</a></div></div>
<div class="ttc" id="astddef_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="stddef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdoc">Define NULL.</div><div class="ttdef"><b>Definition:</b> <a href="stddef_8h_source.html#l00010">stddef.h:10</a></div></div>
<div class="ttc" id="astdint_8h_html_a19e3e47d795881e91fde03c3f592bef4"><div class="ttname"><a href="stdint_8h.html#a19e3e47d795881e91fde03c3f592bef4">uintptr_t</a></div><div class="ttdeci">unsigned uintptr_t</div><div class="ttdoc">Define the unsigned 32-bit pointer.</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00036">stdint.h:36</a></div></div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdoc">Define the unsigned 32-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00018">stdint.h:18</a></div></div>
<div class="ttc" id="astring_8h_html"><div class="ttname"><a href="string_8h.html">string.h</a></div><div class="ttdoc">String routines.</div></div>
<div class="ttc" id="astructkmem__cache__t_html"><div class="ttname"><a href="structkmem__cache__t.html">kmem_cache_t</a></div><div class="ttdoc">Stores the information of a cache.</div><div class="ttdef"><b>Definition:</b> <a href="slab_8h_source.html#l00032">slab.h:32</a></div></div>
<div class="ttc" id="astructmm__struct__t_html_a2de788a48c55d244c8f882272b588ab7"><div class="ttname"><a href="structmm__struct__t.html#a2de788a48c55d244c8f882272b588ab7">mm_struct_t::env_start</a></div><div class="ttdeci">uint32_t env_start</div><div class="ttdoc">ENVIRONMENT start.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00129">paging.h:129</a></div></div>
<div class="ttc" id="astructmm__struct__t_html_a52246f1aa4e4c2bea2a348b87e127651"><div class="ttname"><a href="structmm__struct__t.html#a52246f1aa4e4c2bea2a348b87e127651">mm_struct_t::arg_start</a></div><div class="ttdeci">uint32_t arg_start</div><div class="ttdoc">ARGS start.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00125">paging.h:125</a></div></div>
<div class="ttc" id="astructmm__struct__t_html_a59070ad13bf22a1f293acb8bd509334f"><div class="ttname"><a href="structmm__struct__t.html#a59070ad13bf22a1f293acb8bd509334f">mm_struct_t::arg_end</a></div><div class="ttdeci">uint32_t arg_end</div><div class="ttdoc">ARGS end.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00127">paging.h:127</a></div></div>
<div class="ttc" id="astructmm__struct__t_html_a62b4019cc9b1183e0844041b2a587ba1"><div class="ttname"><a href="structmm__struct__t.html#a62b4019cc9b1183e0844041b2a587ba1">mm_struct_t::pgd</a></div><div class="ttdeci">page_directory_t * pgd</div><div class="ttdoc">Process page directory.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00105">paging.h:105</a></div></div>
<div class="ttc" id="astructmm__struct__t_html_a9bb47616aae930bee79c83dd9d5ee0b6"><div class="ttname"><a href="structmm__struct__t.html#a9bb47616aae930bee79c83dd9d5ee0b6">mm_struct_t::env_end</a></div><div class="ttdeci">uint32_t env_end</div><div class="ttdoc">ENVIRONMENT end.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00131">paging.h:131</a></div></div>
<div class="ttc" id="astructmm__struct__t_html_ab2fd92beef57a21eed753ea54db4d2f7"><div class="ttname"><a href="structmm__struct__t.html#ab2fd92beef57a21eed753ea54db4d2f7">mm_struct_t::start_stack</a></div><div class="ttdeci">uint32_t start_stack</div><div class="ttdoc">STACK start.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00123">paging.h:123</a></div></div>
<div class="ttc" id="astructpage__directory__t_html"><div class="ttname"><a href="structpage__directory__t.html">page_directory_t</a></div><div class="ttdoc">A page directory.</div><div class="ttdef"><b>Definition:</b> <a href="paging_8h_source.html#l00072">paging.h:72</a></div></div>
<div class="ttc" id="astructpt__regs_html"><div class="ttname"><a href="structpt__regs.html">pt_regs</a></div><div class="ttdoc">Interrupt stack frame.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00024">kernel.h:24</a></div></div>
<div class="ttc" id="astructpt__regs_html_a17c833799d2c9404db4f121c1cae602d"><div class="ttname"><a href="structpt__regs.html#a17c833799d2c9404db4f121c1cae602d">pt_regs::eip</a></div><div class="ttdeci">uint32_t eip</div><div class="ttdoc">Instruction Pointer Register.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00054">kernel.h:54</a></div></div>
<div class="ttc" id="astructpt__regs_html_a22433838655905e9e51b071cdddcf67a"><div class="ttname"><a href="structpt__regs.html#a22433838655905e9e51b071cdddcf67a">pt_regs::ecx</a></div><div class="ttdeci">uint32_t ecx</div><div class="ttdoc">32-bit counter.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00046">kernel.h:46</a></div></div>
<div class="ttc" id="astructpt__regs_html_a62e11b5080a51c9642ec1818dd00ebd3"><div class="ttname"><a href="structpt__regs.html#a62e11b5080a51c9642ec1818dd00ebd3">pt_regs::eax</a></div><div class="ttdeci">uint32_t eax</div><div class="ttdoc">32-bit accumulator register.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00048">kernel.h:48</a></div></div>
<div class="ttc" id="astructpt__regs_html_a8b44828360686fafc02f5f0fd92dc81d"><div class="ttname"><a href="structpt__regs.html#a8b44828360686fafc02f5f0fd92dc81d">pt_regs::useresp</a></div><div class="ttdeci">uint32_t useresp</div><div class="ttdoc">User application ESP.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00060">kernel.h:60</a></div></div>
<div class="ttc" id="astructpt__regs_html_a93f56af95cc4ec4c4c32fc78c14cbee2"><div class="ttname"><a href="structpt__regs.html#a93f56af95cc4ec4c4c32fc78c14cbee2">pt_regs::ebx</a></div><div class="ttdeci">uint32_t ebx</div><div class="ttdoc">32-bit base register.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00042">kernel.h:42</a></div></div>
<div class="ttc" id="astructpt__regs_html_ab98af36ae408b8b40fee6b32f26d1955"><div class="ttname"><a href="structpt__regs.html#ab98af36ae408b8b40fee6b32f26d1955">pt_regs::eflags</a></div><div class="ttdeci">uint32_t eflags</div><div class="ttdoc">32-bit flag register.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00058">kernel.h:58</a></div></div>
<div class="ttc" id="astructpt__regs_html_ad7a8313b36ac46e9ea5fb756b8729ed7"><div class="ttname"><a href="structpt__regs.html#ad7a8313b36ac46e9ea5fb756b8729ed7">pt_regs::ebp</a></div><div class="ttdeci">uint32_t ebp</div><div class="ttdoc">32-bit base pointer register.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00038">kernel.h:38</a></div></div>
<div class="ttc" id="astructpt__regs_html_afd15cab97cc4f73329200206c9e60311"><div class="ttname"><a href="structpt__regs.html#afd15cab97cc4f73329200206c9e60311">pt_regs::edx</a></div><div class="ttdeci">uint32_t edx</div><div class="ttdoc">32-bit data register.</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00044">kernel.h:44</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a2de9d073eb3f990f996e0686ff4d1bd9"><div class="ttname"><a href="structsched__entity__t.html#a2de9d073eb3f990f996e0686ff4d1bd9">sched_entity_t::worst_case_exec</a></div><div class="ttdeci">time_t worst_case_exec</div><div class="ttdoc">Worst case execution time.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00061">process.h:61</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a2e65fe87ad396407c3af185d4b0a3d67"><div class="ttname"><a href="structsched__entity__t.html#a2e65fe87ad396407c3af185d4b0a3d67">sched_entity_t::period</a></div><div class="ttdeci">time_t period</div><div class="ttdoc">Expected period of the task.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00047">process.h:47</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a3026f6f756dd93d52e16b817273881a8"><div class="ttname"><a href="structsched__entity__t.html#a3026f6f756dd93d52e16b817273881a8">sched_entity_t::vruntime</a></div><div class="ttdeci">time_t vruntime</div><div class="ttdoc">Weighted execution time.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00044">process.h:44</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a3721bb8381ad787cc48af2b50cceb73b"><div class="ttname"><a href="structsched__entity__t.html#a3721bb8381ad787cc48af2b50cceb73b">sched_entity_t::is_under_analysis</a></div><div class="ttdeci">bool_t is_under_analysis</div><div class="ttdoc">Determines if we need to analyze the WCET of the process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00057">process.h:57</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a405ab87ffe6773166d735bb43a1f445e"><div class="ttname"><a href="structsched__entity__t.html#a405ab87ffe6773166d735bb43a1f445e">sched_entity_t::next_period</a></div><div class="ttdeci">time_t next_period</div><div class="ttdoc">Beginning of next period.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00059">process.h:59</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a4a57005049b5d146bfdda652b9559ceb"><div class="ttname"><a href="structsched__entity__t.html#a4a57005049b5d146bfdda652b9559ceb">sched_entity_t::exec_runtime</a></div><div class="ttdeci">time_t exec_runtime</div><div class="ttdoc">Last execution time.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00040">process.h:40</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a4f3c88b9601fe23334164249919d416a"><div class="ttname"><a href="structsched__entity__t.html#a4f3c88b9601fe23334164249919d416a">sched_entity_t::start_runtime</a></div><div class="ttdeci">time_t start_runtime</div><div class="ttdoc">Start execution time.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00036">process.h:36</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a586727071202ba8ca308cef26ae34ed0"><div class="ttname"><a href="structsched__entity__t.html#a586727071202ba8ca308cef26ae34ed0">sched_entity_t::is_periodic</a></div><div class="ttdeci">bool_t is_periodic</div><div class="ttdoc">Determines if it is a periodic task.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00055">process.h:55</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a6486a4267567a1e952b76f2545ab6fb9"><div class="ttname"><a href="structsched__entity__t.html#a6486a4267567a1e952b76f2545ab6fb9">sched_entity_t::deadline</a></div><div class="ttdeci">time_t deadline</div><div class="ttdoc">Absolute deadline.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00049">process.h:49</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_a68421c07d1b113166935ca5bed2477f1"><div class="ttname"><a href="structsched__entity__t.html#a68421c07d1b113166935ca5bed2477f1">sched_entity_t::arrivaltime</a></div><div class="ttdeci">time_t arrivaltime</div><div class="ttdoc">Absolute time of arrival of the task.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00051">process.h:51</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_ab9d7d6623a4643c4064fff66e053bcab"><div class="ttname"><a href="structsched__entity__t.html#ab9d7d6623a4643c4064fff66e053bcab">sched_entity_t::sum_exec_runtime</a></div><div class="ttdeci">time_t sum_exec_runtime</div><div class="ttdoc">Overall execution time.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00042">process.h:42</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_ac988c4f4160543d00587196a422f0372"><div class="ttname"><a href="structsched__entity__t.html#ac988c4f4160543d00587196a422f0372">sched_entity_t::prio</a></div><div class="ttdeci">int prio</div><div class="ttdoc">Static execution priority.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00033">process.h:33</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_ad1a64c4cc30f02251081f5624ed2fb87"><div class="ttname"><a href="structsched__entity__t.html#ad1a64c4cc30f02251081f5624ed2fb87">sched_entity_t::exec_start</a></div><div class="ttdeci">time_t exec_start</div><div class="ttdoc">Last context switch time.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00038">process.h:38</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_ad9ae10141d13aa58ab6ec68bddc2e320"><div class="ttname"><a href="structsched__entity__t.html#ad9ae10141d13aa58ab6ec68bddc2e320">sched_entity_t::utilization_factor</a></div><div class="ttdeci">double utilization_factor</div><div class="ttdoc">Processor utilization factor.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00063">process.h:63</a></div></div>
<div class="ttc" id="astructsched__entity__t_html_afed011cb6ff510d62bf1559f1590a051"><div class="ttname"><a href="structsched__entity__t.html#afed011cb6ff510d62bf1559f1590a051">sched_entity_t::executed</a></div><div class="ttdeci">bool_t executed</div><div class="ttdoc">Has already executed.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00053">process.h:53</a></div></div>
<div class="ttc" id="astructsigaction__t_html_a4bf7cbd88a54a6683dcb438456fcaed9"><div class="ttname"><a href="structsigaction__t.html#a4bf7cbd88a54a6683dcb438456fcaed9">sigaction_t::sa_flags</a></div><div class="ttdeci">unsigned int sa_flags</div><div class="ttdoc">This set of flags specifies how the signal must be handled;.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00182">signal.h:182</a></div></div>
<div class="ttc" id="astructsigaction__t_html_adf8abbef124ab01c519b8bc3e09e1588"><div class="ttname"><a href="structsigaction__t.html#adf8abbef124ab01c519b8bc3e09e1588">sigaction_t::sa_mask</a></div><div class="ttdeci">sigset_t sa_mask</div><div class="ttdoc">This sigset_t variable specifies the signals to be masked when running the signal handler.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00180">signal.h:180</a></div></div>
<div class="ttc" id="astructsigaction__t_html_ae83dcfae8a4765fb16d883b22b05233f"><div class="ttname"><a href="structsigaction__t.html#ae83dcfae8a4765fb16d883b22b05233f">sigaction_t::sa_handler</a></div><div class="ttdeci">sighandler_t sa_handler</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00178">signal.h:178</a></div></div>
<div class="ttc" id="astructsighand__t_html"><div class="ttname"><a href="structsighand__t.html">sighand_t</a></div><div class="ttdoc">Describes how each signal must be handled.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00186">signal.h:186</a></div></div>
<div class="ttc" id="astructsighand__t_html_a27c78f9500324fbd88db660d133a5151"><div class="ttname"><a href="structsighand__t.html#a27c78f9500324fbd88db660d133a5151">sighand_t::action</a></div><div class="ttdeci">sigaction_t action[NSIG]</div><div class="ttdoc">Array of structures specifying the actions to be performed upon delivering the signals.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00190">signal.h:190</a></div></div>
<div class="ttc" id="astructsighand__t_html_a9bf1d7c5b83d6c1a4cdf8f20075d234e"><div class="ttname"><a href="structsighand__t.html#a9bf1d7c5b83d6c1a4cdf8f20075d234e">sighand_t::count</a></div><div class="ttdeci">atomic_t count</div><div class="ttdoc">Usage counter of the signal handler descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00188">signal.h:188</a></div></div>
<div class="ttc" id="astructsighand__t_html_aafa193b462b7ef7805dd23f6165080c7"><div class="ttname"><a href="structsighand__t.html#aafa193b462b7ef7805dd23f6165080c7">sighand_t::siglock</a></div><div class="ttdeci">spinlock_t siglock</div><div class="ttdoc">Spinlock protecting both the signal descriptor and the signal handler descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00192">signal.h:192</a></div></div>
<div class="ttc" id="astructsigpending__t_html_a6410039ddfa2e759ed9e757c0343296d"><div class="ttname"><a href="structsigpending__t.html#a6410039ddfa2e759ed9e757c0343296d">sigpending_t::signal</a></div><div class="ttdeci">sigset_t signal</div><div class="ttdoc">The mask which can be queried to know which signals are pending.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00240">signal.h:240</a></div></div>
<div class="ttc" id="astructsigpending__t_html_abf2a45f1d6b3cbc09e287a17b825ad35"><div class="ttname"><a href="structsigpending__t.html#abf2a45f1d6b3cbc09e287a17b825ad35">sigpending_t::list</a></div><div class="ttdeci">list_head list</div><div class="ttdoc">Head of the list of pending signals.</div><div class="ttdef"><b>Definition:</b> <a href="mentos_2inc_2system_2signal_8h_source.html#l00238">signal.h:238</a></div></div>
<div class="ttc" id="astructtask__struct_html"><div class="ttname"><a href="structtask__struct.html">task_struct</a></div><div class="ttdoc">this is our task object. Every process in the system has this, and it holds a lot of information....</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00081">process.h:81</a></div></div>
<div class="ttc" id="astructtask__struct_html_a05ab594e57bfe65f52fee4e4a64c6ae8"><div class="ttname"><a href="structtask__struct.html#a05ab594e57bfe65f52fee4e4a64c6ae8">task_struct::pending</a></div><div class="ttdeci">sigpending_t pending</div><div class="ttdoc">Data structure storing the private pending signals.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00133">process.h:133</a></div></div>
<div class="ttc" id="astructtask__struct_html_a08f7db48b607d313ec007f113f79a0ff"><div class="ttname"><a href="structtask__struct.html#a08f7db48b607d313ec007f113f79a0ff">task_struct::fd_list</a></div><div class="ttdeci">vfs_file_descriptor_t * fd_list</div><div class="ttdoc">The current opened file descriptors.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00096">process.h:96</a></div></div>
<div class="ttc" id="astructtask__struct_html_a09266333fd5a7f08d79df3bec124bc02"><div class="ttname"><a href="structtask__struct.html#a09266333fd5a7f08d79df3bec124bc02">task_struct::blocked</a></div><div class="ttdeci">sigset_t blocked</div><div class="ttdoc">Mask of blocked signals.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00127">process.h:127</a></div></div>
<div class="ttc" id="astructtask__struct_html_a11dbdec8ca1c07f55939cc177675417b"><div class="ttname"><a href="structtask__struct.html#a11dbdec8ca1c07f55939cc177675417b">task_struct::sibling</a></div><div class="ttdeci">list_head sibling</div><div class="ttdoc">List of siblings, namely processes created by parent process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00106">process.h:106</a></div></div>
<div class="ttc" id="astructtask__struct_html_a166eff6587e4913092014dc79f24e219"><div class="ttname"><a href="structtask__struct.html#a166eff6587e4913092014dc79f24e219">task_struct::sighand</a></div><div class="ttdeci">sighand_t sighand</div><div class="ttdoc">Pointer to the process’s signal handler descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00125">process.h:125</a></div></div>
<div class="ttc" id="astructtask__struct_html_a21121e97fe6ed0b5862ca53c270a2d2c"><div class="ttname"><a href="structtask__struct.html#a21121e97fe6ed0b5862ca53c270a2d2c">task_struct::se</a></div><div class="ttdeci">sched_entity_t se</div><div class="ttdoc">For scheduling algorithms.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00110">process.h:110</a></div></div>
<div class="ttc" id="astructtask__struct_html_a225f2beda1e687c2f1a1219d5eed4264"><div class="ttname"><a href="structtask__struct.html#a225f2beda1e687c2f1a1219d5eed4264">task_struct::gid</a></div><div class="ttdeci">pid_t gid</div><div class="ttdoc">The Group ID (GID) of the process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00089">process.h:89</a></div></div>
<div class="ttc" id="astructtask__struct_html_a318e5619b8c058b3255bf751ac80086b"><div class="ttname"><a href="structtask__struct.html#a318e5619b8c058b3255bf751ac80086b">task_struct::name</a></div><div class="ttdeci">char name[TASK_NAME_MAX_LENGTH]</div><div class="ttdoc">The name of the task (Added for debug purpose).</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00114">process.h:114</a></div></div>
<div class="ttc" id="astructtask__struct_html_a3d9992a8fc049fa059d2b3d6b9f33d84"><div class="ttname"><a href="structtask__struct.html#a3d9992a8fc049fa059d2b3d6b9f33d84">task_struct::real_timer</a></div><div class="ttdeci">struct timer_list * real_timer</div><div class="ttdoc">Timer for alarm syscall.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00136">process.h:136</a></div></div>
<div class="ttc" id="astructtask__struct_html_a4e1d1b7290f3f0e0cae580aa90012e49"><div class="ttname"><a href="structtask__struct.html#a4e1d1b7290f3f0e0cae580aa90012e49">task_struct::max_fd</a></div><div class="ttdeci">int max_fd</div><div class="ttdoc">The maximum supported number of file descriptors.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00098">process.h:98</a></div></div>
<div class="ttc" id="astructtask__struct_html_a604a8ed7213cf3158b0c66ae37cb151b"><div class="ttname"><a href="structtask__struct.html#a604a8ed7213cf3158b0c66ae37cb151b">task_struct::pgid</a></div><div class="ttdeci">pid_t pgid</div><div class="ttdoc">The Process Group Id of the process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00087">process.h:87</a></div></div>
<div class="ttc" id="astructtask__struct_html_a7c21f2477fef8029c5ffaa7dd9701b66"><div class="ttname"><a href="structtask__struct.html#a7c21f2477fef8029c5ffaa7dd9701b66">task_struct::cwd</a></div><div class="ttdeci">char cwd[PATH_MAX]</div><div class="ttdoc">The current working directory.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00120">process.h:120</a></div></div>
<div class="ttc" id="astructtask__struct_html_a826ddf06710b68d6162078018fc889a0"><div class="ttname"><a href="structtask__struct.html#a826ddf06710b68d6162078018fc889a0">task_struct::keyboard_rb</a></div><div class="ttdeci">fs_rb_scancode_t keyboard_rb</div><div class="ttdoc">Buffer for managing inputs from keyboard.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00154">process.h:154</a></div></div>
<div class="ttc" id="astructtask__struct_html_a82d82c47076ad83874b1ee7dbb714a3f"><div class="ttname"><a href="structtask__struct.html#a82d82c47076ad83874b1ee7dbb714a3f">task_struct::thread</a></div><div class="ttdeci">thread_struct_t thread</div><div class="ttdoc">The context of the processors.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00108">process.h:108</a></div></div>
<div class="ttc" id="astructtask__struct_html_a87a3d5ad21a9dddfed14474e06ed16fb"><div class="ttname"><a href="structtask__struct.html#a87a3d5ad21a9dddfed14474e06ed16fb">task_struct::state</a></div><div class="ttdeci">__volatile__ long state</div><div class="ttdoc">The current state of the process:</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00094">process.h:94</a></div></div>
<div class="ttc" id="astructtask__struct_html_a8e1eeb14f703a13dd30762bfdad9fbf1"><div class="ttname"><a href="structtask__struct.html#a8e1eeb14f703a13dd30762bfdad9fbf1">task_struct::children</a></div><div class="ttdeci">list_head children</div><div class="ttdoc">List of children traced by the process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00104">process.h:104</a></div></div>
<div class="ttc" id="astructtask__struct_html_a91a8e2117841c08b1275c47dbf009dbb"><div class="ttname"><a href="structtask__struct.html#a91a8e2117841c08b1275c47dbf009dbb">task_struct::uid</a></div><div class="ttdeci">pid_t uid</div><div class="ttdoc">The User ID (UID) of the user owning the process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00091">process.h:91</a></div></div>
<div class="ttc" id="astructtask__struct_html_a9ce8a6402466dc66f29a068f1018cccd"><div class="ttname"><a href="structtask__struct.html#a9ce8a6402466dc66f29a068f1018cccd">task_struct::termios</a></div><div class="ttdeci">termios_t termios</div><div class="ttdoc">Process-wise terminal options.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00152">process.h:152</a></div></div>
<div class="ttc" id="astructtask__struct_html_abee19f114e04018f4502b79e07906614"><div class="ttname"><a href="structtask__struct.html#abee19f114e04018f4502b79e07906614">task_struct::real_blocked</a></div><div class="ttdeci">sigset_t real_blocked</div><div class="ttdoc">Temporary mask of blocked signals (used by the rt_sigtimedwait() system call)</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00129">process.h:129</a></div></div>
<div class="ttc" id="astructtask__struct_html_ac96426eb73337a26f33fb75a6aa97ac3"><div class="ttname"><a href="structtask__struct.html#ac96426eb73337a26f33fb75a6aa97ac3">task_struct::error_no</a></div><div class="ttdeci">int error_no</div><div class="ttdoc">Task's specific error number.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00118">process.h:118</a></div></div>
<div class="ttc" id="astructtask__struct_html_ad9da706c569dce6f2cbe25498b7aa96b"><div class="ttname"><a href="structtask__struct.html#ad9da706c569dce6f2cbe25498b7aa96b">task_struct::exit_code</a></div><div class="ttdeci">int exit_code</div><div class="ttdoc">Exit code of the process. (parameter of _exit() system call).</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00112">process.h:112</a></div></div>
<div class="ttc" id="astructtask__struct_html_adf88d82850f399c473998758ea3c6ba7"><div class="ttname"><a href="structtask__struct.html#adf88d82850f399c473998758ea3c6ba7">task_struct::saved_sigmask</a></div><div class="ttdeci">sigset_t saved_sigmask</div><div class="ttdoc">The previous sig mask.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00131">process.h:131</a></div></div>
<div class="ttc" id="astructtask__struct_html_ae6a7bebb0a13a0c56887478eac73345f"><div class="ttname"><a href="structtask__struct.html#ae6a7bebb0a13a0c56887478eac73345f">task_struct::mm</a></div><div class="ttdeci">mm_struct_t * mm</div><div class="ttdoc">Task's segments.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00116">process.h:116</a></div></div>
<div class="ttc" id="astructtask__struct_html_ae8f3745f8f0965e880550784b7f33790"><div class="ttname"><a href="structtask__struct.html#ae8f3745f8f0965e880550784b7f33790">task_struct::parent</a></div><div class="ttdeci">struct task_struct * parent</div><div class="ttdoc">Pointer to process's parent.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00100">process.h:100</a></div></div>
<div class="ttc" id="astructtask__struct_html_aed999fed29759312b5c75d5f3dae5631"><div class="ttname"><a href="structtask__struct.html#aed999fed29759312b5c75d5f3dae5631">task_struct::run_list</a></div><div class="ttdeci">list_head run_list</div><div class="ttdoc">List head for scheduling purposes.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00102">process.h:102</a></div></div>
<div class="ttc" id="astructtask__struct_html_af87ae9f3a8a1bf7e6333909836d7ae68"><div class="ttname"><a href="structtask__struct.html#af87ae9f3a8a1bf7e6333909836d7ae68">task_struct::sid</a></div><div class="ttdeci">pid_t sid</div><div class="ttdoc">The session id of the process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00085">process.h:85</a></div></div>
<div class="ttc" id="astructtask__struct_html_afc180f9e1e6ace46019d9560d008b515"><div class="ttname"><a href="structtask__struct.html#afc180f9e1e6ace46019d9560d008b515">task_struct::pid</a></div><div class="ttdeci">pid_t pid</div><div class="ttdoc">The pid of the process.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00083">process.h:83</a></div></div>
<div class="ttc" id="astructtermios_html_a5d42b95faa4745c3bea53652d2812162"><div class="ttname"><a href="structtermios.html#a5d42b95faa4745c3bea53652d2812162">termios::c_cflag</a></div><div class="ttdeci">tcflag_t c_cflag</div><div class="ttdoc">control mode flags</div><div class="ttdef"><b>Definition:</b> <a href="termios-struct_8h_source.html#l00021">termios-struct.h:21</a></div></div>
<div class="ttc" id="astructthread__struct__t_html"><div class="ttname"><a href="structthread__struct__t.html">thread_struct_t</a></div><div class="ttdoc">Stores the status of CPU and FPU registers.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00067">process.h:67</a></div></div>
<div class="ttc" id="astructthread__struct__t_html_a79be545a9f244204d197e84f1ead8027"><div class="ttname"><a href="structthread__struct__t.html#a79be545a9f244204d197e84f1ead8027">thread_struct_t::regs</a></div><div class="ttdeci">pt_regs regs</div><div class="ttdoc">Stored status of registers.</div><div class="ttdef"><b>Definition:</b> <a href="process_8h_source.html#l00069">process.h:69</a></div></div>
<div class="ttc" id="astructvfs__file__descriptor__t_html"><div class="ttname"><a href="structvfs__file__descriptor__t.html">vfs_file_descriptor_t</a></div><div class="ttdoc">Data structure containing information about an open file.</div><div class="ttdef"><b>Definition:</b> <a href="vfs__types_8h_source.html#l00151">vfs_types.h:151</a></div></div>
<div class="ttc" id="astructvfs__file__descriptor__t_html_a220f786ab67346d6c887facead27c6fa"><div class="ttname"><a href="structvfs__file__descriptor__t.html#a220f786ab67346d6c887facead27c6fa">vfs_file_descriptor_t::file_struct</a></div><div class="ttdeci">vfs_file_t * file_struct</div><div class="ttdoc">the underlying file structure</div><div class="ttdef"><b>Definition:</b> <a href="vfs__types_8h_source.html#l00153">vfs_types.h:153</a></div></div>
<div class="ttc" id="astructvfs__file__descriptor__t_html_abbd3d0bdd98801c356854c41773eff12"><div class="ttname"><a href="structvfs__file__descriptor__t.html#abbd3d0bdd98801c356854c41773eff12">vfs_file_descriptor_t::flags_mask</a></div><div class="ttdeci">int flags_mask</div><div class="ttdoc">Flags for file opening modes.</div><div class="ttdef"><b>Definition:</b> <a href="vfs__types_8h_source.html#l00155">vfs_types.h:155</a></div></div>
<div class="ttc" id="astructvfs__file__t_html"><div class="ttname"><a href="structvfs__file__t.html">vfs_file_t</a></div><div class="ttdoc">Data structure that contains information about the mounted filesystems.</div><div class="ttdef"><b>Definition:</b> <a href="vfs__types_8h_source.html#l00093">vfs_types.h:93</a></div></div>
<div class="ttc" id="astructvfs__file__t_html_a2ff81c7a70dcd649de7e34c29a49e539"><div class="ttname"><a href="structvfs__file__t.html#a2ff81c7a70dcd649de7e34c29a49e539">vfs_file_t::count</a></div><div class="ttdeci">int count</div><div class="ttdoc">Number of file descriptors associated with this file.</div><div class="ttdef"><b>Definition:</b> <a href="vfs__types_8h_source.html#l00115">vfs_types.h:115</a></div></div>
<div class="ttc" id="astructvfs__file__t_html_ad977c810d41b0cbd8a0fe2d25f6e8a31"><div class="ttname"><a href="structvfs__file__t.html#ad977c810d41b0cbd8a0fe2d25f6e8a31">vfs_file_t::flags</a></div><div class="ttdeci">uint32_t flags</div><div class="ttdoc">Flags (node type, etc).</div><div class="ttdef"><b>Definition:</b> <a href="vfs__types_8h_source.html#l00105">vfs_types.h:105</a></div></div>
<div class="ttc" id="astructvfs__file__t_html_afe85064c0f0b0a96a543cecd00d7dec3"><div class="ttname"><a href="structvfs__file__t.html#afe85064c0f0b0a96a543cecd00d7dec3">vfs_file_t::name</a></div><div class="ttdeci">char name[NAME_MAX]</div><div class="ttdoc">The filename.</div><div class="ttdef"><b>Definition:</b> <a href="vfs__types_8h_source.html#l00095">vfs_types.h:95</a></div></div>
<div class="ttc" id="atermios-struct_8h_html_a52c605497d066b9ae7407124f84806a7"><div class="ttname"><a href="termios-struct_8h.html#a52c605497d066b9ae7407124f84806a7">ISIG</a></div><div class="ttdeci">#define ISIG</div><div class="ttdoc">Controls whether the INTR, QUIT, and SUSP characters are recognized.</div><div class="ttdef"><b>Definition:</b> <a href="termios-struct_8h_source.html#l00033">termios-struct.h:33</a></div></div>
<div class="ttc" id="atermios-struct_8h_html_a58265a371303d00a4a3b1f128d72c21e"><div class="ttname"><a href="termios-struct_8h.html#a58265a371303d00a4a3b1f128d72c21e">ICANON</a></div><div class="ttdeci">#define ICANON</div><div class="ttdoc">Enables canonical input processing mode.</div><div class="ttdef"><b>Definition:</b> <a href="termios-struct_8h_source.html#l00034">termios-struct.h:34</a></div></div>
<div class="ttc" id="atermios-struct_8h_html_a6695c16777cf8a5211cfba9a23d45985"><div class="ttname"><a href="termios-struct_8h.html#a6695c16777cf8a5211cfba9a23d45985">ECHOK</a></div><div class="ttdeci">#define ECHOK</div><div class="ttdoc">If ICANON is set, the KILL character erases the current line.</div><div class="ttdef"><b>Definition:</b> <a href="termios-struct_8h_source.html#l00037">termios-struct.h:37</a></div></div>
<div class="ttc" id="atermios-struct_8h_html_a785e51f802fcd542f2acf152438db6f9"><div class="ttname"><a href="termios-struct_8h.html#a785e51f802fcd542f2acf152438db6f9">termios_t</a></div><div class="ttdeci">struct termios termios_t</div><div class="ttdoc">Stores information about a terminal IOs.</div></div>
<div class="ttc" id="atermios-struct_8h_html_aac931d3ce0dfc4578f76879ed095ecd7"><div class="ttname"><a href="termios-struct_8h.html#aac931d3ce0dfc4578f76879ed095ecd7">ECHOE</a></div><div class="ttdeci">#define ECHOE</div><div class="ttdoc">If ICANON is set, the ERASE character erases the preceding character.</div><div class="ttdef"><b>Definition:</b> <a href="termios-struct_8h_source.html#l00036">termios-struct.h:36</a></div></div>
<div class="ttc" id="atermios-struct_8h_html_aad1dc60a04a1d8cfc8b3ded13601e361"><div class="ttname"><a href="termios-struct_8h.html#aad1dc60a04a1d8cfc8b3ded13601e361">ECHO</a></div><div class="ttdeci">#define ECHO</div><div class="ttdoc">Echo input characters.</div><div class="ttdef"><b>Definition:</b> <a href="termios-struct_8h_source.html#l00035">termios-struct.h:35</a></div></div>
<div class="ttc" id="atermios-struct_8h_html_ad99516e614e3aa680dfc0052085de40a"><div class="ttname"><a href="termios-struct_8h.html#ad99516e614e3aa680dfc0052085de40a">ECHONL</a></div><div class="ttdeci">#define ECHONL</div><div class="ttdoc">If ICANON is set, echo the NL character even if ECHO is not set.</div><div class="ttdef"><b>Definition:</b> <a href="termios-struct_8h_source.html#l00038">termios-struct.h:38</a></div></div>
<div class="ttc" id="atimer_8h_html"><div class="ttname"><a href="timer_8h.html">timer.h</a></div><div class="ttdoc">Programmable Interval Timer (PIT) definitions.</div></div>
<div class="ttc" id="atimer_8h_html_ae23bd2d068dae6da28f9dc8226a7138f"><div class="ttname"><a href="timer_8h.html#ae23bd2d068dae6da28f9dc8226a7138f">timer_get_ticks</a></div><div class="ttdeci">unsigned long timer_get_ticks()</div><div class="ttdoc">Returns the number of ticks since the system started its execution.</div><div class="ttdef"><b>Definition:</b> <a href="timer_8c_source.html#l00136">timer.c:136</a></div></div>
<div class="ttc" id="avfs_8h_html"><div class="ttname"><a href="vfs_8h.html">vfs.h</a></div><div class="ttdoc">Headers for Virtual File System (VFS).</div></div>
<div class="ttc" id="avfs_8h_html_a103648a7259f3be7ca1f79b3d247359b"><div class="ttname"><a href="vfs_8h.html#a103648a7259f3be7ca1f79b3d247359b">vfs_open</a></div><div class="ttdeci">vfs_file_t * vfs_open(const char *pathname, int flags, mode_t mode)</div><div class="ttdoc">Given a pathname for a file, kopen() returns a file struct, used to access the file.</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8c_source.html#l00112">vfs.c:112</a></div></div>
<div class="ttc" id="avfs_8h_html_a656125edb733622bdd879037a3986411"><div class="ttname"><a href="vfs_8h.html#a656125edb733622bdd879037a3986411">vfs_dup_task</a></div><div class="ttdeci">int vfs_dup_task(struct task_struct *new_task, struct task_struct *old_task)</div><div class="ttdoc">Duplicate the file descriptor list of old_task into new_task.</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8c_source.html#l00517">vfs.c:517</a></div></div>
<div class="ttc" id="avfs_8h_html_a660060cf4085fd34e511f81921e38e56"><div class="ttname"><a href="vfs_8h.html#a660060cf4085fd34e511f81921e38e56">vfs_init_task</a></div><div class="ttdeci">int vfs_init_task(struct task_struct *task)</div><div class="ttdoc">Initialize the file descriptor list for the given task.</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8c_source.html#l00497">vfs.c:497</a></div></div>
<div class="ttc" id="avfs_8h_html_a6e3812039538e7780756472cdb932086"><div class="ttname"><a href="vfs_8h.html#a6e3812039538e7780756472cdb932086">vfs_close</a></div><div class="ttdeci">int vfs_close(vfs_file_t *file)</div><div class="ttdoc">Decreases the number of references to a given file, if the references number reaches 0,...</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8c_source.html#l00154">vfs.c:154</a></div></div>
<div class="ttc" id="avfs_8h_html_abd165ee6474b5b75bf075842fff13a04"><div class="ttname"><a href="vfs_8h.html#abd165ee6474b5b75bf075842fff13a04">STDOUT_FILENO</a></div><div class="ttdeci">#define STDOUT_FILENO</div><div class="ttdoc">Standard output.</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00014">vfs.h:14</a></div></div>
<div class="ttc" id="avfs_8h_html_ae2fe1725bb5e9823d089c46b9ed5266e"><div class="ttname"><a href="vfs_8h.html#ae2fe1725bb5e9823d089c46b9ed5266e">STDERR_FILENO</a></div><div class="ttdeci">#define STDERR_FILENO</div><div class="ttdoc">Standard error output.</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00015">vfs.h:15</a></div></div>
<div class="ttc" id="avfs_8h_html_afcf80a6d91178952d107ad00b165752b"><div class="ttname"><a href="vfs_8h.html#afcf80a6d91178952d107ad00b165752b">STDIN_FILENO</a></div><div class="ttdeci">#define STDIN_FILENO</div><div class="ttdoc">Standard input.</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00013">vfs.h:13</a></div></div>
</div><!-- fragment --></div><!-- contents -->
        <!-- HTML footer for doxygen 1.8.16-->
        <!-- start footer part -->
        <div class="footer">
            <hr class="footer" />
            <ul class="footer-info">
                <li class="footer-info-lastmode">
                    This page was last modified on Fri Dec 9 2022 11:34:53.
                </li>
                <li class="footer-info-copyright">
                    MentOs © 2014–2022 the MentOs-Team, and numerous contributors.<br>
                    It is available for use and modification under the&#160;
                    <a href="md_LICENSE.html">MIT License</a>.<br>
                </li>
            </ul>
            <hr class="footer" />
            <address class="footer">
                Generated by&#160;
                <a href="http://www.doxygen.org/index.html">
                    <img class="footer" src="doxygen.png" alt="doxygen" />
                </a> 1.9.1
            </address>
        </div>
    </body>
</html>