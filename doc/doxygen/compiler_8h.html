<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.9.1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MentOS: mentos/inc/klib/compiler.h File Reference</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                    <tr style="height: 56px;">
                        <td id="projectalign" style="padding-left: 0.5em;">
                            <div id="projectname">MentOS
                                &#160;<span id="projectnumber">0.5.2</span>
                            </div>
                            <div id="projectbrief">The Mentoring Operating System</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part --><!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b4d46abdb8cafe1ad6c14fa0f9992e34.html">mentos</a></li><li class="navelem"><a class="el" href="dir_b043e71e4766e108b8d8f74323da14bd.html">inc</a></li><li class="navelem"><a class="el" href="dir_f05eee54a8d148069806d040d57064bb.html">klib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">compiler.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Definition of memory barriers.  
<a href="#details">More...</a></p>

<p><a href="compiler_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5a5ce2d19e893e6131143f0895d60131"><td class="memItemLeft" align="right" valign="top"><a id="a5a5ce2d19e893e6131143f0895d60131"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compiler_8h.html#a5a5ce2d19e893e6131143f0895d60131">WRITE_ONCE</a>(var,  val)&#160;&#160;&#160;(*((volatile typeof(val) *)(&amp;(var))) = (val))</td></tr>
<tr class="memdesc:a5a5ce2d19e893e6131143f0895d60131"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign the value to the given variable. <br /></td></tr>
<tr class="separator:a5a5ce2d19e893e6131143f0895d60131"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4503f801c4d0fc8da14eaf068ce62297"><td class="memItemLeft" align="right" valign="top"><a id="a4503f801c4d0fc8da14eaf068ce62297"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compiler_8h.html#a4503f801c4d0fc8da14eaf068ce62297">READ_ONCE</a>(var)&#160;&#160;&#160;(*((volatile typeof(var) *)(&amp;(var))))</td></tr>
<tr class="memdesc:a4503f801c4d0fc8da14eaf068ce62297"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the value from the given variable. <br /></td></tr>
<tr class="separator:a4503f801c4d0fc8da14eaf068ce62297"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Definition of memory barriers. </p>
<p>Generally speaking, memory barriers prevent the compiler from merging or refetching reads or writes. Ensuring that the compiler does not fold, spindle, or otherwise mutilate accesses that either do not require ordering or that interact with an explicit memory barrier or atomic instruction that provides the required ordering.</p>
<p>Follows an extract from <code>LINUX KERNEL MEMORY BARRIERS</code> by: David Howells, Paul E. McKenney, Will Deacon, Peter Zijlstra, available at: <a href="https://www.kernel.org/doc/Documentation/memory-barriers.txt">https://www.kernel.org/doc/Documentation/memory-barriers.txt</a></p>
<p>Consider the following abstract model of the system: </p><div class="fragment"><div class="line">            :                :</div>
<div class="line">+-------+   :   +--------+   :   +-------+</div>
<div class="line">| CPU 1 |&lt;-----&gt;| Memory |&lt;-----&gt;| CPU 2 |</div>
<div class="line">+-------+   :   +--------+   :   +-------+</div>
<div class="line">    ^       :       ^        :       ^</div>
<div class="line">    |       :       |        :       |</div>
<div class="line">    |       :       v        :       |</div>
<div class="line">    |       :   +--------+   :       |</div>
<div class="line">    +----------&gt;| Device |&lt;----------+</div>
<div class="line">            :   +--------+   :</div>
<div class="line">            :                :</div>
</div><!-- fragment --><p> Each CPU executes a program that generates memory access operations. In the abstract CPU, memory operation ordering is very relaxed, and a CPU may actually perform the memory operations in any order it likes, provided program causality appears to be maintained. Similarly, the compiler may also arrange the instructions it emits in any order it likes, provided it doesn't affect the apparent operation of the program.</p>
<p>So in the above diagram, the effects of the memory operations performed by a CPU are perceived by the rest of the system as the operations cross the interface between the CPU and rest of the system (the dotted lines).</p>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) 2014-2022 This file is distributed under the MIT License. See LICENSE.md for details. </dd></dl>

<p class="definition">Definition in file <a class="el" href="compiler_8h_source.html">compiler.h</a>.</p>
</div></div><!-- contents -->
        <!-- HTML footer for doxygen 1.8.16-->
        <!-- start footer part -->
        <div class="footer">
            <hr class="footer" />
            <ul class="footer-info">
                <li class="footer-info-lastmode">
                    This page was last modified on Fri Dec 9 2022 11:34:53.
                </li>
                <li class="footer-info-copyright">
                    MentOs © 2014–2022 the MentOs-Team, and numerous contributors.<br>
                    It is available for use and modification under the&#160;
                    <a href="md_LICENSE.html">MIT License</a>.<br>
                </li>
            </ul>
            <hr class="footer" />
            <address class="footer">
                Generated by&#160;
                <a href="http://www.doxygen.org/index.html">
                    <img class="footer" src="doxygen.png" alt="doxygen" />
                </a> 1.9.1
            </address>
        </div>
    </body>
</html>